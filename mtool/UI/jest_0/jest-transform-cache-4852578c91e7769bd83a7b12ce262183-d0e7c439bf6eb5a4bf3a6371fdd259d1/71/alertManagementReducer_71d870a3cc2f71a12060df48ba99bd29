4294b756b300231e0496f016aac537a6
"use strict";

var _interopRequireWildcard = require("/home/ibof07/pk/ibofmgmt/Code/UI/node_modules/@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("/home/ibof07/pk/ibofmgmt/Code/UI/node_modules/@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _defineProperty2 = _interopRequireDefault(require("/home/ibof07/pk/ibofmgmt/Code/UI/node_modules/@babel/runtime/helpers/defineProperty"));

var actionTypes = _interopRequireWildcard(require("../actions/actionTypes"));

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

const initialState = {
  selected: false,
  edit: false,
  alerts: [],
  // For Alert Table
  alertClusters: [{
    // For Alert Types
    _id: '1',
    name: 'CPU',
    alertSubCluster: [{
      _id: '1',
      name: 'cpu-host',
      alertTypes: [{
        type: 'cpu-idle'
      }, {
        type: 'cpu-idle2'
      }, {
        type: 'cpu-affinity'
      }]
    }, {
      _id: '2',
      name: 'cpu-host2',
      alertTypes: [{
        type: 'cpu-idle'
      }, {
        type: 'cpu-affinity'
      }, {
        type: 'cpu-time'
      }]
    }],
    alertFields: ["usage_idle", "usage_system"]
  }, {
    _id: '2',
    name: 'Array',
    alertSubCluster: [{
      name: 'array-disk0',
      alertTypes: [{
        type: 'array-name'
      }, {
        type: 'array-size'
      }]
    }]
  }],
  istypealert: false,
  alerttype: '',
  alertOpen: false,
  addDeleteSend: '',
  alerttitle: '',
  alertdescription: ''
};

const alertManagementReducer = (state = initialState, action) => {
  switch (action.type) {
    case actionTypes.ALERT_MANAGEMENT_OPEN_ALERT_BOX:
      {
        return _objectSpread({}, state, {}, action.alertParam);
      }

    case actionTypes.ALERT_MANAGEMENT_SET_ALERTS:
      {
        const _action$updatedAlerts = action.updatedAlerts,
              type = _action$updatedAlerts.type,
              i = _action$updatedAlerts.i,
              j = _action$updatedAlerts.j;
        const value1 = i;
        const value2 = j;
        const alertClusters = state.alertClusters.map((cluster, Citr) => {
          return _objectSpread({}, cluster, {
            alertSubCluster: cluster.alertSubCluster.map((subcluster, subCitr) => {
              return _objectSpread({}, subcluster, {
                alertTypes: subcluster.alertTypes.map(cip => {
                  if (type.type === cip.type && Citr === value1 && subCitr === value2) {
                    return _objectSpread({}, cip, {
                      selected: !cip.selected
                    });
                  }

                  if (cip.selected === true && value1 === Citr && subCitr === value2) {
                    return _objectSpread({}, cip);
                  }

                  return _objectSpread({}, cip, {
                    selected: false
                  });
                })
              });
            })
          });
        });
        return _objectSpread({}, state, {
          alertClusters
        });
      }

    case actionTypes.ALERT_MANAGEMENT_FETCH_ALERTS:
      {
        const alerts = [];
        action.alerts.forEach(alert => {
          alerts.push(_objectSpread({}, alert, {
            selected: false,
            edit: false
          }));
        });
        return _objectSpread({}, state, {
          alerts
        });
      }

    case actionTypes.ALERT_MANAGEMENT_FETCH_ALERTS_TYPE:
      {
        const alertTypesArray = [];

        for (let i = 0; i < action.alertTypes.length; i += 1) {
          if (action.alertTypes[i].name === 'cpu') {
            action.alertTypes[i].alertFields = [// 'usage_idle',
            'usage_user'];

            for (let j = 0; j < action.alertTypes[i].alertSubCluster.length; j += 1) {
              if (action.alertTypes[i].alertSubCluster[j].name === 'cpu') {
                action.alertTypes[i].alertSubCluster = action.alertTypes[i].alertSubCluster.filter(item => item.name === 'cpu');
                action.alertTypes[i].alertSubCluster[j].alertTypes = action.alertTypes[i].alertSubCluster[j].alertTypes.filter(item => item.type === 'cpu-total');
                action.alertTypes[i].alertSubCluster[j].name = 'cpu ';
              }
            }

            alertTypesArray.push(action.alertTypes[i]);
          } // else if (action.alertTypes[i].name === 'disk') {
          //     for (
          //         let j = 0;
          //         j < action.alertTypes[i].alertSubCluster.length;
          //         j += 1
          //     ) {
          //         if (action.alertTypes[i].alertSubCluster[j].name !== 'device') {
          //             action.alertTypes[i].alertSubCluster = action.alertTypes[
          //                 i
          //             ].alertSubCluster.filter(item => item.name === 'device');
          //         } else {
          //             action.alertTypes[i].alertSubCluster[
          //                 j
          //             ].alertTypes = action.alertTypes[i].alertSubCluster[
          //                 j
          //             ].alertTypes.slice(0, 1);
          //             action.alertTypes[i].alertSubCluster[j].alertTypes.map(
          //                 (item) => {
          //                     const resItem = { ...item }
          //                     resItem.type = 'NA';
          //                     return resItem;
          //                 }
          //             );
          //         }
          //     }
          //     action.alertTypes[i].alertFields = ['NA'];
          //     alertTypesArray.push(action.alertTypes[i]);
          // }

        }

        return _objectSpread({}, state, {
          alertClusters: alertTypesArray
        });
      }

    default:
      return state;
  }
};

var _default = alertManagementReducer;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFsZXJ0TWFuYWdlbWVudFJlZHVjZXIuanMiXSwibmFtZXMiOlsiaW5pdGlhbFN0YXRlIiwic2VsZWN0ZWQiLCJlZGl0IiwiYWxlcnRzIiwiYWxlcnRDbHVzdGVycyIsIl9pZCIsIm5hbWUiLCJhbGVydFN1YkNsdXN0ZXIiLCJhbGVydFR5cGVzIiwidHlwZSIsImFsZXJ0RmllbGRzIiwiaXN0eXBlYWxlcnQiLCJhbGVydHR5cGUiLCJhbGVydE9wZW4iLCJhZGREZWxldGVTZW5kIiwiYWxlcnR0aXRsZSIsImFsZXJ0ZGVzY3JpcHRpb24iLCJhbGVydE1hbmFnZW1lbnRSZWR1Y2VyIiwic3RhdGUiLCJhY3Rpb24iLCJhY3Rpb25UeXBlcyIsIkFMRVJUX01BTkFHRU1FTlRfT1BFTl9BTEVSVF9CT1giLCJhbGVydFBhcmFtIiwiQUxFUlRfTUFOQUdFTUVOVF9TRVRfQUxFUlRTIiwidXBkYXRlZEFsZXJ0cyIsImkiLCJqIiwidmFsdWUxIiwidmFsdWUyIiwibWFwIiwiY2x1c3RlciIsIkNpdHIiLCJzdWJjbHVzdGVyIiwic3ViQ2l0ciIsImNpcCIsIkFMRVJUX01BTkFHRU1FTlRfRkVUQ0hfQUxFUlRTIiwiZm9yRWFjaCIsImFsZXJ0IiwicHVzaCIsIkFMRVJUX01BTkFHRU1FTlRfRkVUQ0hfQUxFUlRTX1RZUEUiLCJhbGVydFR5cGVzQXJyYXkiLCJsZW5ndGgiLCJmaWx0ZXIiLCJpdGVtIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBMkJBOzs7Ozs7QUFFQSxNQUFNQSxZQUFZLEdBQUc7QUFDakJDLEVBQUFBLFFBQVEsRUFBRSxLQURPO0FBRWpCQyxFQUFBQSxJQUFJLEVBQUUsS0FGVztBQUdqQkMsRUFBQUEsTUFBTSxFQUFFLEVBSFM7QUFHTDtBQUNaQyxFQUFBQSxhQUFhLEVBQUUsQ0FDWDtBQUNJO0FBQ0FDLElBQUFBLEdBQUcsRUFBRSxHQUZUO0FBR0lDLElBQUFBLElBQUksRUFBRSxLQUhWO0FBSUlDLElBQUFBLGVBQWUsRUFBRSxDQUNiO0FBQ0lG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ZCxVQUFBQSxhQUFhLEVBQUVvQztBQUZuQjtBQUlIOztBQUNMO0FBQ0ksYUFBT3RCLEtBQVA7QUE3SFI7QUErSEgsQ0FoSUQ7O2VBa0llRCxzQiIsInNvdXJjZXNDb250ZW50IjpbIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0vXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvXG4vICAgICAgICAgICAgICAgQ09QWVJJR0hUIChjKSAyMDE5IFNBTVNVTkcgRUxFQ1RST05JQ1MgQ08uLCBMVEQuICAgICAgICAgICAgICAgICAgICAgIC9cbi8gICAgICAgICAgICAgICAgICAgICAgICAgIEFMTCBSSUdIVFMgUkVTRVJWRUQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgL1xuLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvXG4vICAgUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCB0byBsaWNlbnNlZXMgb2YgU2Ftc3VuZyBFbGVjdHJvbmljcyBDby4sIEx0ZC4gICAgICAgIC9cbi8gICBwcm9kdWN0cyB0byB1c2Ugb3IgYWJzdHJhY3QgdGhpcyBjb21wdXRlciBwcm9ncmFtIGZvciB0aGUgc29sZSBwdXJwb3NlIG9mICAgICAgICAgL1xuLyAgIGltcGxlbWVudGluZyBhIHByb2R1Y3QgYmFzZWQgb24gU2Ftc3VuZyBFbGVjdHJvbmljcyBDby4sIEx0ZC4gcHJvZHVjdHMuICAgICAgICAgICAvXG4vICAgTm8gb3RoZXIgcmlnaHRzIHRvIHJlcHJvZHVjZSwgdXNlLCBvciBkaXNzZW1pbmF0ZSB0aGlzIGNvbXB1dGVyIHByb2dyYW0sICAgICAgICAgIC9cbi8gICB3aGV0aGVyIGluIHBhcnQgb3IgaW4gd2hvbGUsIGFyZSBncmFudGVkLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyBcbi8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgL1xuLyAgIFNhbXN1bmcgRWxlY3Ryb25pY3MgQ28uLCBMdGQuIG1ha2VzIG5vIHJlcHJlc2VudGF0aW9uIG9yIHdhcnJhbnRpZXMgd2l0aCAgICAgICAgICAvXG4vICAgcmVzcGVjdCB0byB0aGUgcGVyZm9ybWFuY2Ugb2YgdGhpcyBjb21wdXRlciBwcm9ncmFtLCBhbmQgc3BlY2lmaWNhbGx5IGRpc2NsYWltcyAgIC9cbi8gICBhbnkgcmVzcG9uc2liaWxpdHkgZm9yIGFueSBkYW1hZ2VzLCBzcGVjaWFsIG9yIGNvbnNlcXVlbnRpYWwsIGNvbm5lY3RlZCAgICAgICAgICAgL1xuLyAgIHdpdGggdGhlIHVzZSBvZiB0aGlzIHByb2dyYW0uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvXG4vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC9cbi8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tL1xuXG5cbkRFU0NSSVBUSU9OOiA8Q29udGFpbnMgcmVkdWNlciBmdW5jdGlvbiBmb3IgQWxlcnQgTWFuYWdlbWVudCBDb250YWluZXI+ICpcbkBOQU1FIDogYWxlcnRNYW5hZ2VtZW50UmVkdWNlci5qc1xuQEFVVEhPUlM6IEpheSBIaXRlc2ggU2FuZ2hhdmkgXG5AVmVyc2lvbiA6IDEuMCAqXG5AUkVWSVNJT04gSElTVE9SWVxuWzAzLzA2LzIwMTldIFtKYXldIDogUHJvdG90eXBpbmcuLi4uLi4uLi4uLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiovXG5cbmltcG9ydCAqIGFzIGFjdGlvblR5cGVzIGZyb20gXCIuLi9hY3Rpb25zL2FjdGlvblR5cGVzXCJcblxuY29uc3QgaW5pdGlhbFN0YXRlID0ge1xuICAgIHNlbGVjdGVkOiBmYWxzZSxcbiAgICBlZGl0OiBmYWxzZSxcbiAgICBhbGVydHM6IFtdLCAvLyBGb3IgQWxlcnQgVGFibGVcbiAgICBhbGVydENsdXN0ZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIEZvciBBbGVydCBUeXBlc1xuICAgICAgICAgICAgX2lkOiAnMScsXG4gICAgICAgICAgICBuYW1lOiAnQ1BVJyxcbiAgICAgICAgICAgIGFsZXJ0U3ViQ2x1c3RlcjogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgX2lkOiAnMScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdjcHUtaG9zdCcsXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0VHlwZXM6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY3B1LWlkbGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY3B1LWlkbGUyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2NwdS1hZmZpbml0eScsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBfaWQ6ICcyJyxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2NwdS1ob3N0MicsXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0VHlwZXM6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY3B1LWlkbGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY3B1LWFmZmluaXR5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2NwdS10aW1lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBhbGVydEZpZWxkczogW1widXNhZ2VfaWRsZVwiLFwidXNhZ2Vfc3lzdGVtXCJdLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBfaWQ6ICcyJyxcbiAgICAgICAgICAgIG5hbWU6ICdBcnJheScsXG4gICAgICAgICAgICBhbGVydFN1YkNsdXN0ZXI6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdhcnJheS1kaXNrMCcsXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0VHlwZXM6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnYXJyYXktbmFtZScsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdhcnJheS1zaXplJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgIH0sXG4gICAgXSxcbiAgICBpc3R5cGVhbGVydDogZmFsc2UsXG4gICAgYWxlcnR0eXBlOiAnJyxcbiAgICBhbGVydE9wZW46IGZhbHNlLFxuICAgIGFkZERlbGV0ZVNlbmQ6ICcnLFxuICAgIGFsZXJ0dGl0bGU6ICcnLFxuICAgIGFsZXJ0ZGVzY3JpcHRpb246ICcnLFxufVxuXG5cbmNvbnN0IGFsZXJ0TWFuYWdlbWVudFJlZHVjZXIgPSAoc3RhdGUgPSBpbml0aWFsU3RhdGUsIGFjdGlvbikgPT4ge1xuICAgIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICAgICAgY2FzZSBhY3Rpb25UeXBlcy5BTEVSVF9NQU5BR0VNRU5UX09QRU5fQUxFUlRfQk9YOlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybntcbiAgICAgICAgICAgICAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgIC4uLmFjdGlvbi5hbGVydFBhcmFtXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBjYXNlIGFjdGlvblR5cGVzLkFMRVJUX01BTkFHRU1FTlRfU0VUX0FMRVJUUzpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IHR5cGUsIGksIGogfSA9IGFjdGlvbi51cGRhdGVkQWxlcnRzO1xuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlMSA9IGk7XG4gICAgICAgICAgICAgICAgY29uc3QgdmFsdWUyID0gajtcbiAgICAgICAgICAgICAgICBjb25zdCBhbGVydENsdXN0ZXJzID0gc3RhdGUuYWxlcnRDbHVzdGVycy5tYXAoKGNsdXN0ZXIsIENpdHIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLmNsdXN0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydFN1YkNsdXN0ZXI6IGNsdXN0ZXIuYWxlcnRTdWJDbHVzdGVyLm1hcCgoc3ViY2x1c3Rlciwgc3ViQ2l0cikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnN1YmNsdXN0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0VHlwZXM6IHN1YmNsdXN0ZXIuYWxlcnRUeXBlcy5tYXAoY2lwID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlLnR5cGUgPT09IGNpcC50eXBlICYmIENpdHIgPT09IHZhbHVlMSAmJiBzdWJDaXRyID09PSB2YWx1ZTIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi5jaXAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiAhY2lwLnNlbGVjdGVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2lwLnNlbGVjdGVkID09PSB0cnVlICYmIHZhbHVlMSA9PT0gQ2l0ciAmJiBzdWJDaXRyID09PSB2YWx1ZTIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi5jaXAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4uY2lwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgYWxlcnRDbHVzdGVycyxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICBjYXNlIGFjdGlvblR5cGVzLkFMRVJUX01BTkFHRU1FTlRfRkVUQ0hfQUxFUlRTOlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFsZXJ0cyA9IFtdO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5hbGVydHMuZm9yRWFjaChhbGVydCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLmFsZXJ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLnN0YXRlLFxuICAgICAgICAgICAgICAgICAgICBhbGVydHMsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICBjYXNlIGFjdGlvblR5cGVzLkFMRVJUX01BTkFHRU1FTlRfRkVUQ0hfQUxFUlRTX1RZUEU6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc3QgYWxlcnRUeXBlc0FycmF5ID0gW107XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhY3Rpb24uYWxlcnRUeXBlcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aW9uLmFsZXJ0VHlwZXNbaV0ubmFtZSA9PT0gJ2NwdScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5hbGVydFR5cGVzW2ldLmFsZXJ0RmllbGRzID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICd1c2FnZV9pZGxlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndXNhZ2VfdXNlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gJ3VzYWdlX3N5c3RlbScsXG4gICAgICAgICAgICAgICAgICAgICAgICBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaiA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA8IGFjdGlvbi5hbGVydFR5cGVzW2ldLmFsZXJ0U3ViQ2x1c3Rlci5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaiArPSAxXG4gICAgICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aW9uLmFsZXJ0VHlwZXNbaV0uYWxlcnRTdWJDbHVzdGVyW2pdLm5hbWUgPT09ICdjcHUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5hbGVydFR5cGVzW2ldLmFsZXJ0U3ViQ2x1c3RlciA9IGFjdGlvbi5hbGVydFR5cGVzW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLmFsZXJ0U3ViQ2x1c3Rlci5maWx0ZXIoaXRlbSA9PiBpdGVtLm5hbWUgPT09ICdjcHUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLmFsZXJ0VHlwZXNbaV0uYWxlcnRTdWJDbHVzdGVyW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgalxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLmFsZXJ0VHlwZXMgPSBhY3Rpb24uYWxlcnRUeXBlc1tpXS5hbGVydFN1YkNsdXN0ZXJbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0uYWxlcnRUeXBlcy5maWx0ZXIoaXRlbSA9PiBpdGVtLnR5cGUgPT09ICdjcHUtdG90YWwnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLmFsZXJ0VHlwZXNbaV0uYWxlcnRTdWJDbHVzdGVyW2pdLm5hbWUgPSAnY3B1ICc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnRUeXBlc0FycmF5LnB1c2goYWN0aW9uLmFsZXJ0VHlwZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICAgICAgLy8gZWxzZSBpZiAoYWN0aW9uLmFsZXJ0VHlwZXNbaV0ubmFtZSA9PT0gJ2Rpc2snKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICBmb3IgKFxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGxldCBqID0gMDtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBqIDwgYWN0aW9uLmFsZXJ0VHlwZXNbaV0uYWxlcnRTdWJDbHVzdGVyLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBqICs9IDFcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICkge1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGlmIChhY3Rpb24uYWxlcnRUeXBlc1tpXS5hbGVydFN1YkNsdXN0ZXJbal0ubmFtZSAhPT0gJ2RldmljZScpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgYWN0aW9uLmFsZXJ0VHlwZXNbaV0uYWxlcnRTdWJDbHVzdGVyID0gYWN0aW9uLmFsZXJ0VHlwZXNbXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICBpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIF0uYWxlcnRTdWJDbHVzdGVyLmZpbHRlcihpdGVtID0+IGl0ZW0ubmFtZSA9PT0gJ2RldmljZScpO1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGFjdGlvbi5hbGVydFR5cGVzW2ldLmFsZXJ0U3ViQ2x1c3RlcltcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIGpcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgXS5hbGVydFR5cGVzID0gYWN0aW9uLmFsZXJ0VHlwZXNbaV0uYWxlcnRTdWJDbHVzdGVyW1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgalxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgICBdLmFsZXJ0VHlwZXMuc2xpY2UoMCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIGFjdGlvbi5hbGVydFR5cGVzW2ldLmFsZXJ0U3ViQ2x1c3RlcltqXS5hbGVydFR5cGVzLm1hcChcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzSXRlbSA9IHsgLi4uaXRlbSB9XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgcmVzSXRlbS50eXBlID0gJ05BJztcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzSXRlbTtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICBhY3Rpb24uYWxlcnRUeXBlc1tpXS5hbGVydEZpZWxkcyA9IFsnTkEnXTtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIGFsZXJ0VHlwZXNBcnJheS5wdXNoKGFjdGlvbi5hbGVydFR5cGVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgYWxlcnRDbHVzdGVyczogYWxlcnRUeXBlc0FycmF5LFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgYWxlcnRNYW5hZ2VtZW50UmVkdWNlcjtcbiJdfQ==