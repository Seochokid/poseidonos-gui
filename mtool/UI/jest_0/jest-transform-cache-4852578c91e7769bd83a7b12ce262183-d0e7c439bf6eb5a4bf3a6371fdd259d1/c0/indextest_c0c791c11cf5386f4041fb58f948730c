b4d68ded29003b25955101003c51835f
"use strict";

jest.unmock('axios');

var _interopRequireDefault = require("/home/ibof07/pk/ibofmgmt/Code/UI/node_modules/@babel/runtime/helpers/interopRequireDefault");

var _index = _interopRequireDefault(require("./index"));

var _testUtils = require("@material-ui/core/test-utils");

var _react = _interopRequireDefault(require("react"));

var _react2 = require("@testing-library/react");

var _reactRedux = require("react-redux");

require("@testing-library/jest-dom/extend-expect");

var _reactI18next = require("react-i18next");

var _axios = _interopRequireDefault(require("axios"));

var _axiosMockAdapter = _interopRequireDefault(require("axios-mock-adapter"));

var _history = require("history");

var _reactRouterDom = require("react-router-dom");

var _redux = require("redux");

var _reduxSaga = _interopRequireDefault(require("redux-saga"));

var _indexSaga = _interopRequireDefault(require("../../sagas/indexSaga"));

var _headerReducer = _interopRequireDefault(require("../../store/reducers/headerReducer"));

var _dashboardReducer = _interopRequireDefault(require("../../store/reducers/dashboardReducer"));

var _configurationsettingReducer = _interopRequireDefault(require("../../store/reducers/configurationsettingReducer"));

var _BMCAuthenticationReducer = _interopRequireDefault(require("../../store/reducers/BMCAuthenticationReducer"));

var _i18n = _interopRequireDefault(require("../../i18n"));

var _jsxFileName = "/home/ibof07/pk/ibofmgmt/Code/UI/src/containers/Dashboard/index.test.js";
describe("Dashboard", () => {
  let wrapper;
  let history;
  let store;
  beforeEach(() => {
    const sagaMiddleware = (0, _reduxSaga.default)();
    const rootReducers = (0, _redux.combineReducers)({
      headerReducer: _headerReducer.default,
      dashboardReducer: _dashboardReducer.default,
      configurationsettingReducer: _configurationsettingReducer.default,
      BMCAuthenticationReducer: _BMCAuthenticationReducer.default
    });
    const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || _redux.compose;
    store = (0, _redux.createStore)(rootReducers, composeEnhancers((0, _redux.applyMiddleware)(sagaMiddleware)));
    sagaMiddleware.run(_indexSaga.default);
    const route = '/';
    history = (0, _history.createMemoryHistory)({
      initialEntries: [route]
    });
  });

  const renderComponent = () => {
    wrapper = (0, _react2.render)(_react.default.createElement(_reactRouterDom.Router, {
      history: history,
      __source: {
        fileName: _jsxFileName,
        lineNumber: 52
      },
      __self: void 0
    }, _react.default.createElement(_reactI18next.I18nextProvider, {
      i18n: _i18n.default,
      __source: {
        fileName: _jsxFileName,
        lineNumber: 53
      },
      __self: void 0
    }, _react.default.createElement(_reactRedux.Provider, {
      store: store,
      __source: {
        fileName: _jsxFileName,
        lineNumber: 54
      },
      __self: void 0
    }, " ", _react.default.createElement(_index.default, {
      __source: {
        fileName: _jsxFileName,
        lineNumber: 56
      },
      __self: void 0
    })))));
  };

  afterEach(_react2.cleanup);
  it("matches snapshot", () => {
    renderComponent();
    const _wrapper = wrapper,
          asFragment = _wrapper.asFragment;
    expect(asFragment()).toMatchSnapshot();
  });
  it("should display available storage value as received from API", async () => {
    const mock = new _axiosMockAdapter.default(_axios.default);
    mock.onGet(`/api/v1.0/available_storage/?ts= + ${Date.now()}`).reply(200, [{
      arraySize: 0
    }]);
    renderComponent();
    const _wrapper2 = wrapper,
          getByTestId = _wrapper2.getByTestId;
    const readStorageElement = await (0, _react2.waitForElement)(() => getByTestId("dashboard-no-array"));
    expect(readStorageElement.innerHTML).toBe("No Array Created");
  });
  it("should display system info as received from API", async () => {
    const mock = new _axiosMockAdapter.default(_axios.default);
    mock.onGet(`/api/v1.0/get_ip_and_mac`).reply(200, {
      host: "init",
      ip: "10.1.11.91",
      mac: "00:50:56:ad:88:56"
    });
    renderComponent();
    const _wrapper3 = wrapper,
          getByTestId = _wrapper3.getByTestId;
    const ipElement = await (0, _react2.waitForElement)(() => getByTestId("dashboard-ip"));
    expect(ipElement.innerHTML).toBe("IP : 10.1.11.91");
    const hostElement = await (0, _react2.waitForElement)(() => getByTestId("dashboard-host"));
    expect(hostElement.innerHTML).toBe("Poseidon Name : init");
    const macElement = await (0, _react2.waitForElement)(() => getByTestId("dashboard-mac"));
    expect(macElement.innerHTML).toBe("MAC : 00:50:56:ad:88:56");
  });
  it("should display storage details", async () => {
    const mock = new _axiosMockAdapter.default(_axios.default);
    mock.onGet(/api\/v1\.0\/available_storage\/\?ts=*/).reply(200, [{
      arraySize: 4768219004928
    }]);
    renderComponent();
    const _wrapper4 = wrapper,
          getByText = _wrapper4.getByText;
    const hostElement = await (0, _react2.waitForElement)(() => getByText("4.34 TB"));
    expect(hostElement).toBeDefined();
  });
  it("should display volumes", async () => {
    const mock = new _axiosMockAdapter.default(_axios.default);
    mock.onGet(`/api/v1.0/get_volumes/`).reply(200, [{
      id: '0',
      maxbw: 0,
      maxiops: 0,
      name: 'vol2',
      remain: 10737418240,
      status: 'Mounted',
      total: 10737418240,
      ip: '10.1.11.91',
      port: 'NA',
      subnqn: 'NA',
      description: "",
      unit: 'GB',
      size: '10',
      usedspace: 0
    }]);
    renderComponent();
    const _wrapper5 = wrapper,
          getByText = _wrapper5.getByText;
    const hostElement = await (0, _react2.waitForElement)(() => getByText("vol2"));
    expect(hostElement).toBeDefined();
  });
  it("should display alerts", async () => {
    const mock = new _axiosMockAdapter.default(_axios.default);
    mock.onGet(`/api/v1.0/get_alert_info`).reply(200, {
      alerts: [{
        time: 104256782,
        level: 'CRITICAL',
        message: 'CPU Alert',
        duration: 10,
        host: 'iBoF'
      }, {
        time: 104256783,
        level: 'NORMAL',
        message: 'iBoF Alert',
        duration: 10,
        host: 'iBoF'
      }]
    });
    renderComponent();
    const _wrapper6 = wrapper,
          getByText = _wrapper6.getByText;
    const hostElement1 = await (0, _react2.waitForElement)(() => getByText("CPU Alert"));
    expect(hostElement1).toBeDefined();
    const hostElement2 = await (0, _react2.waitForElement)(() => getByText("iBoF Alert"));
    expect(hostElement2).toBeDefined();
  });
  it('should render button on resize', () => {
    // Change the viewport to 500px.
    global.innerWidth = 500; // Trigger the window resize event.

    global.dispatchEvent(new Event('resize'));
    renderComponent();
    const _wrapper7 = wrapper,
          getByTestId = _wrapper7.getByTestId;
    expect(getByTestId("sidebar-toggle")).toBeDefined();

    _react2.fireEvent.click(getByTestId("sidebar-toggle"));

    expect(getByTestId("help-link")).toHaveTextContent("Help");
  });
  it("should display iops value as received from API", async () => {
    jest.useFakeTimers();
    const mock = new _axiosMockAdapter.default(_axios.default);
    mock.onGet(/\/api\/v1\.0\/perf\/all\?ts=*/).reply(200, {
      bw_read: 0,
      bw_total: 0,
      bw_write: 0,
      iops_read: 154,
      iops_total: 0,
      iops_write: 154
    }).onAny().reply(200, {});
    renderComponent();
    jest.advanceTimersByTime(2000);
    const _wrapper8 = wrapper,
          getByTestId = _wrapper8.getByTestId;
    const readIopsElement = await (0, _react2.waitForElement)(() => getByTestId("read-iops"));
    expect(readIopsElement.innerHTML).toBe("0");
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnRlc3QuanMiXSwibmFtZXMiOlsiamVzdCIsInVubW9jayIsImRlc2NyaWJlIiwid3JhcHBlciIsImhpc3RvcnkiLCJzdG9yZSIsImJlZm9yZUVhY2giLCJzYWdhTWlkZGxld2FyZSIsInJvb3RSZWR1Y2VycyIsImhlYWRlclJlZHVjZXIiLCJkYXNoYm9hcmRSZWR1Y2VyIiwiY29uZmlndXJhdGlvbnNldHRpbmdSZWR1Y2VyIiwiQk1DQXV0aGVudGljYXRpb25SZWR1Y2VyIiwiY29tcG9zZUVuaGFuY2VycyIsIndpbmRvdyIsIl9fUkVEVVhfREVWVE9PTFNfRVhURU5TSU9OX0NPTVBPU0VfXyIsImNvbXBvc2UiLCJydW4iLCJyb290U2FnYSIsInJvdXRlIiwiaW5pdGlhbEVudHJpZXMiLCJyZW5kZXJDb21wb25lbnQiLCJpMThuIiwiYWZ0ZXJFYWNoIiwiY2xlYW51cCIsIml0IiwiYXNGcmFnbWVudCIsImV4cGVjdCIsInRvTWF0Y2hTbmFwc2hvdCIsIm1vY2siLCJNb2NrQWRhcHRlciIsImF4aW9zIiwib25HZXQiLCJEYXRlIiwibm93IiwicmVwbHkiLCJhcnJheVNpemUiLCJnZXRCeVRlc3RJZCIsInJlYWRTdG9yYWdlRWxlbWVudCIsImlubmVySFRNTCIsInRvQmUiLCJob3N0IiwiaXAiLCJtYWMiLCJpcEVsZW1lbnQiLCJob3N0RWxlbWVudCIsIm1hY0VsZW1lbnQiLCJnZXRCeVRleHQiLCJ0b0JlRGVmaW5lZCIsImlkIiwibWF4YnciLCJtYXhpb3BzIiwibmFtZSIsInJlbWFpbiIsInN0YXR1cyIsInRvdGFsIiwicG9ydCIsInN1Ym5xbiIsImRlc2NyaXB0aW9uIiwidW5pdCIsInNpemUiLCJ1c2Vkc3BhY2UiLCJhbGVydHMiLCJ0aW1lIiwibGV2ZWwiLCJtZXNzYWdlIiwiZHVyYXRpb24iLCJob3N0RWxlbWVudDEiLCJob3N0RWxlbWVudDIiLCJnbG9iYWwiLCJpbm5lcldpZHRoIiwiZGlzcGF0Y2hFdmVudCIsIkV2ZW50IiwiZmlyZUV2ZW50IiwiY2xpY2siLCJ0b0hhdmVUZXh0Q29udGVudCIsInVzZUZha2VUaW1lcnMiLCJid19yZWFkIiwiYndfdG90YWwiLCJid193cml0ZSIsImlvcHNfcmVhZCIsImlvcHNfdG90YWwiLCJpb3BzX3dyaXRlIiwib25BbnkiLCJhZHZhbmNlVGltZXJzQnlUaW1lIiwicmVhZElvcHNFbGVtZW50Il0sIm1hcHBpbmdzIjoiOztBQXVCQUEsSUFBSSxDQUFDQyxNQUFMLENBQVksT0FBWjs7OztBQXRCQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFHQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7O0FBS0FDLFFBQVEsQ0FBQyxXQUFELEVBQWMsTUFBTTtBQUN4QixNQUFJQyxPQUFKO0FBQ0EsTUFBSUMsT0FBSjtBQUNBLE1BQUlDLEtBQUo7QUFFQUMsRUFBQUEsVUFBVSxDQUFDLE1BQU07QUFDZixVQUFNQyxjQUFjLEdBQUcseUJBQXZCO0FBQ0EsVUFBTUMsWUFBWSxHQUFHLDRCQUFnQjtBQUNuQ0MsTUFBQUEsYUFBYSxFQUFiQSxzQkFEbUM7QUFFbkNDLE1BQUFBLGdCQUFnQixFQUFoQkEseUJBRm1DO0FBR25DQyxNQUFBQSwyQkFBMkIsRUFBM0JBLG9DQUhtQztBQUluQ0MsTUFBQUEsd0JBQXdCLEVBQXhCQTtBQUptQyxLQUFoQixDQUFyQjtBQU1BLFVBQU1DLGdCQUFnQixHQUFHQyxNQUFNLENBQUNDLG9DQUFQLElBQStDQyxjQUF4RTtBQUNBWCxJQUFBQSxLQUFLLEdBQUcsd0JBQVlHLFlBQVosRUFBeUJLLGdCQUFnQixDQUFDLDRCQUFnQk4sY0FBaEIsQ0FBRCxDQUF6QyxDQUFSO0FBQ0FBLElBQUFBLGNBQWMsQ0FBQ1UsR0FBZixDQUFtQkMsa0JBQW5CO0FBQ0EsVUFBTUMsS0FBSyxHQUFHLEdBQWQ7QUFDQWYsSUFBQUEsT0FBTyxHQUFHLGtDQUFvQjtBQUFFZ0IsTUFBQUEsY0FBYyxFQUFFLENB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QUFBLFNBQVMsRUFBRSxHQUpmO0FBS0lDLE1BQUFBLFVBQVUsRUFBRSxDQUxoQjtBQU1JQyxNQUFBQSxVQUFVLEVBQUU7QUFOaEIsS0FGSixFQVVJQyxLQVZKLEdBVVloRCxLQVZaLENBVWtCLEdBVmxCLEVBVXVCLEVBVnZCO0FBV0FkLElBQUFBLGVBQWU7QUFDZnJCLElBQUFBLElBQUksQ0FBQ29GLG1CQUFMLENBQXlCLElBQXpCO0FBZitELHNCQWdCekNqRixPQWhCeUM7QUFBQSxVQWdCeERrQyxXQWhCd0QsYUFnQnhEQSxXQWhCd0Q7QUFpQi9ELFVBQU1nRCxlQUFlLEdBQUcsTUFBTSw0QkFBZSxNQUFNaEQsV0FBVyxDQUFDLFdBQUQsQ0FBaEMsQ0FBOUI7QUFDQVYsSUFBQUEsTUFBTSxDQUFDMEQsZUFBZSxDQUFDOUMsU0FBakIsQ0FBTixDQUFrQ0MsSUFBbEMsQ0FBdUMsR0FBdkM7QUFDRCxHQW5CQyxDQUFGO0FBcUJMLENBcE1PLENBQVIiLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCBEYXNoYm9hcmQgZnJvbSBcIi4vaW5kZXhcIjtcbmltcG9ydCB7IGNyZWF0ZU1vdW50IH0gZnJvbSAnQG1hdGVyaWFsLXVpL2NvcmUvdGVzdC11dGlscyc7XG5pbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQge3JlbmRlcixmaXJlRXZlbnQsIGNsZWFudXAsIHdhaXRGb3JFbGVtZW50LCBnZXROb2RlVGV4dH0gZnJvbSBcIkB0ZXN0aW5nLWxpYnJhcnkvcmVhY3RcIjtcbmltcG9ydCB7IFByb3ZpZGVyIH0gZnJvbSBcInJlYWN0LXJlZHV4XCI7XG5pbXBvcnQgXCJAdGVzdGluZy1saWJyYXJ5L2plc3QtZG9tL2V4dGVuZC1leHBlY3RcIjtcbmltcG9ydCB7IEkxOG5leHRQcm92aWRlciB9IGZyb20gXCJyZWFjdC1pMThuZXh0XCI7XG4vL2ltcG9ydCBheGlvc01vY2sgZnJvbSAnYXhpb3MnO1xuXG5pbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnO1xuaW1wb3J0IE1vY2tBZGFwdGVyIGZyb20gJ2F4aW9zLW1vY2stYWRhcHRlcidcbmltcG9ydCB7IGNyZWF0ZU1lbW9yeUhpc3RvcnkgfSBmcm9tICdoaXN0b3J5JztcbmltcG9ydCB7Um91dGVyfSBmcm9tICdyZWFjdC1yb3V0ZXItZG9tJztcbmltcG9ydCB7IGNyZWF0ZVN0b3JlLCBjb21iaW5lUmVkdWNlcnMsYXBwbHlNaWRkbGV3YXJlLGNvbXBvc2UgfSBmcm9tIFwicmVkdXhcIjtcbmltcG9ydCBjcmVhdGVTYWdhTWlkZGxld2FyZSBmcm9tICdyZWR1eC1zYWdhJ1xuaW1wb3J0IHJvb3RTYWdhIGZyb20gXCIuLi8uLi9zYWdhcy9pbmRleFNhZ2FcIlxuaW1wb3J0IGhlYWRlclJlZHVjZXIgZnJvbSBcIi4uLy4uL3N0b3JlL3JlZHVjZXJzL2hlYWRlclJlZHVjZXJcIjtcbmltcG9ydCBkYXNoYm9hcmRSZWR1Y2VyIGZyb20gXCIuLi8uLi9zdG9yZS9yZWR1Y2Vycy9kYXNoYm9hcmRSZWR1Y2VyXCI7XG5pbXBvcnQgY29uZmlndXJhdGlvbnNldHRpbmdSZWR1Y2VyIGZyb20gXCIuLi8uLi9zdG9yZS9yZWR1Y2Vycy9jb25maWd1cmF0aW9uc2V0dGluZ1JlZHVjZXJcIjtcbmltcG9ydCBCTUNBdXRoZW50aWNhdGlvblJlZHVjZXIgZnJvbSBcIi4uLy4uL3N0b3JlL3JlZHVjZXJzL0JNQ0F1dGhlbnRpY2F0aW9uUmVkdWNlclwiO1xuaW1wb3J0IGkxOG4gZnJvbSBcIi4uLy4uL2kxOG5cIjtcblxuamVzdC51bm1vY2soJ2F4aW9zJyk7XG5cblxuZGVzY3JpYmUoXCJEYXNoYm9hcmRcIiwgKCkgPT4ge1xuICAgIGxldCB3cmFwcGVyO1xuICAgIGxldCBoaXN0b3J5O1xuICAgIGxldCBzdG9yZTtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgY29uc3Qgc2FnYU1pZGRsZXdhcmUgPSBjcmVhdGVTYWdhTWlkZGxld2FyZSgpO1xuICAgICAgY29uc3Qgcm9vdFJlZHVjZXJzID0gY29tYmluZVJlZHVjZXJzKHtcbiAgICAgICAgaGVhZGVyUmVkdWNlcixcbiAgICAgICAgZGFzaGJvYXJkUmVkdWNlcixcbiAgICAgICAgY29uZmlndXJhdGlvbnNldHRpbmdSZWR1Y2VyLFxuICAgICAgICBCTUNBdXRoZW50aWNhdGlvblJlZHVjZXJcbiAgICAgIH0pO1xuICAgICAgY29uc3QgY29tcG9zZUVuaGFuY2VycyA9IHdpbmRvdy5fX1JFRFVYX0RFVlRPT0xTX0VYVEVOU0lPTl9DT01QT1NFX18gfHwgY29tcG9zZTtcbiAgICAgIHN0b3JlID0gY3JlYXRlU3RvcmUocm9vdFJlZHVjZXJzLGNvbXBvc2VFbmhhbmNlcnMoYXBwbHlNaWRkbGV3YXJlKHNhZ2FNaWRkbGV3YXJlKSkpXG4gICAgICBzYWdhTWlkZGxld2FyZS5ydW4ocm9vdFNhZ2EpO1xuICAgICAgY29uc3Qgcm91dGUgPSAnLyc7XG4gICAgICBoaXN0b3J5ID0gY3JlYXRlTWVtb3J5SGlzdG9yeSh7IGluaXRpYWxFbnRyaWVzOiBbcm91dGVdIH0pXG4gIFxuXG4gICAgfSk7XG5cbiAgICBcbiAgICBjb25zdCByZW5kZXJDb21wb25lbnQgPSAoKSA9PiB7XG4gICAgICAgIHdyYXBwZXIgPSByZW5kZXIoXG4gICAgICAgICAgPFJvdXRlciBoaXN0b3J5PXtoaXN0b3J5fT5cbiAgICAgICAgICA8STE4bmV4dFByb3ZpZGVyIGkxOG49e2kxOG59PlxuICAgICAgICAgICAgPFByb3ZpZGVyIHN0b3JlPXtzdG9yZX0+XG4gICAgICAgICAgICAgIHtcIiBcIn1cbiAgICAgICAgICAgICAgPERhc2hib2FyZCAvPlxuICAgICAgICAgICAgPC9Qcm92aWRlcj5cbiAgICAgICAgICA8L0kxOG5leHRQcm92aWRlcj5cbiAgICAgICAgICA8L1JvdXRlcj5cbiAgICAgICAgKTtcbiAgICB9O1xuICBcbiAgICBhZnRlckVhY2goY2xlYW51cCk7XG4gIFxuICAgIGl0KFwibWF0Y2hlcyBzbmFwc2hvdFwiLCAoKSA9PiB7XG4gICAgICByZW5kZXJDb21wb25lbnQoKTtcbiAgICAgIGNvbnN0IHsgYXNGcmFnbWVudCB9ID0gd3JhcHBlcjtcbiAgICAgIGV4cGVjdChhc0ZyYWdtZW50KCkpLnRvTWF0Y2hTbmFwc2hvdCgpO1xuICAgIH0pO1xuXG5cbiAgICBpdChcInNob3VsZCBkaXNwbGF5IGF2YWlsYWJsZSBzdG9yYWdlIHZhbHVlIGFzIHJlY2VpdmVkIGZyb20gQVBJXCIsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgbW9jayA9IG5ldyBNb2NrQWRhcHRlcihheGlvcyk7XG4gICAgICAgIG1vY2sub25HZXQoYC9hcGkvdjEuMC9hdmFpbGFibGVfc3RvcmFnZS8/dHM9ICsgJHtEYXRlLm5vdygpfWApXG4gICAgICAgICAgLnJlcGx5KDIwMCwgW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBhcnJheVNpemU6IDAsIFxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgICAgICk7XG4gICAgICAgIHJlbmRlckNvbXBvbmVudCgpO1xuICAgICAgICBjb25zdCB7IGdldEJ5VGVzdElkfSA9IHdyYXBwZXI7XG4gICAgICAgIGNvbnN0IHJlYWRTdG9yYWdlRWxlbWVudCA9IGF3YWl0IHdhaXRGb3JFbGVtZW50KCgpID0+IGdldEJ5VGVzdElkKFwiZGFzaGJvYXJkLW5vLWFycmF5XCIpKTtcbiAgICAgICAgZXhwZWN0KHJlYWRTdG9yYWdlRWxlbWVudC5pbm5lckhUTUwpLnRvQmUoXCJObyBBcnJheSBDcmVhdGVkXCIpO1xuXG4gICAgICB9KTtcblxuXG4gICAgICBcbiAgICBpdChcInNob3VsZCBkaXNwbGF5IHN5c3RlbSBpbmZvIGFzIHJlY2VpdmVkIGZyb20gQVBJXCIsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgbW9jayA9IG5ldyBNb2NrQWRhcHRlcihheGlvcyk7XG4gICAgICAgIG1vY2sub25HZXQoYC9hcGkvdjEuMC9nZXRfaXBfYW5kX21hY2ApXG4gICAgICAgICAgLnJlcGx5KDIwMCwgICAgICAgICBcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBob3N0OiBcImluaXRcIiwgXG4gICAgICAgICAgICAgICAgaXA6IFwiMTAuMS4xMS45MVwiLCBcbiAgICAgICAgICAgICAgICBtYWM6IFwiMDA6NTA6NTY6YWQ6ODg6NTZcIlxuICAgICAgICAgICAgICB9IFxuICAgICAgICBcbiAgICAgICAgICApO1xuICAgICAgICByZW5kZXJDb21wb25lbnQoKTtcbiAgICAgICAgY29uc3QgeyBnZXRCeVRlc3RJZH0gPSB3cmFwcGVyO1xuICAgICAgICBjb25zdCBpcEVsZW1lbnQgPSBhd2FpdCB3YWl0Rm9yRWxlbWVudCgoKSA9PiBnZXRCeVRlc3RJZChcImRhc2hib2FyZC1pcFwiKSk7XG4gICAgICAgIGV4cGVjdChpcEVsZW1lbnQuaW5uZXJIVE1MKS50b0JlKFwiSVAgOiAxMC4xLjExLjkxXCIpO1xuXG5cbiAgICAgICAgY29uc3QgaG9zdEVsZW1lbnQgPSBhd2FpdCB3YWl0Rm9yRWxlbWVudCgoKSA9PiBnZXRCeVRlc3RJZChcImRhc2hib2FyZC1ob3N0XCIpKTtcbiAgICAgICAgZXhwZWN0KGhvc3RFbGVtZW50LmlubmVySFRNTCkudG9CZShcIlBvc2VpZG9uIE5hbWUgOiBpbml0XCIpO1xuXG4gICAgICAgIGNvbnN0IG1hY0VsZW1lbnQgPSBhd2FpdCB3YWl0Rm9yRWxlbWVudCgoKSA9PiBnZXRCeVRlc3RJZChcImRhc2hib2FyZC1tYWNcIikpO1xuICAgICAgICBleHBlY3QobWFjRWxlbWVudC5pbm5lckhUTUwpLnRvQmUoXCJNQUMgOiAwMDo1MDo1NjphZDo4ODo1NlwiKTtcblxuICAgICAgfSk7XG5cbiAgICAgIGl0KFwic2hvdWxkIGRpc3BsYXkgc3RvcmFnZSBkZXRhaWxzXCIsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgbW9jayA9IG5ldyBNb2NrQWRhcHRlcihheGlvcyk7XG4gICAgICAgIG1vY2sub25HZXQoL2FwaVxcL3YxXFwuMFxcL2F2YWlsYWJsZV9zdG9yYWdlXFwvXFw/dHM9Ki8pXG4gICAgICAgICAgLnJlcGx5KDIwMCwgW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBhcnJheVNpemU6IDQ3NjgyMTkwMDQ5MjhcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdKTtcbiAgICAgICAgcmVuZGVyQ29tcG9uZW50KCk7XG4gICAgICAgIGNvbnN0IHsgZ2V0QnlUZXh0IH0gPSB3cmFwcGVyO1xuICAgICAgICBjb25zdCBob3N0RWxlbWVudCA9IGF3YWl0IHdhaXRGb3JFbGVtZW50KCgpID0+IGdldEJ5VGV4dChcIjQuMzQgVEJcIikpO1xuICAgICAgICBleHBlY3QoaG9zdEVsZW1lbnQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoXCJzaG91bGQgZGlzcGxheSB2b2x1bWVzXCIsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgbW9jayA9IG5ldyBNb2NrQWRhcHRlcihheGlvcyk7XG4gICAgICAgIG1vY2sub25HZXQoYC9hcGkvdjEuMC9nZXRfdm9sdW1lcy9gKVxuICAgICAgICAgIC5yZXBseSgyMDAsW1xuICAgICAgICAgICAgeyAgICAgICAgIFxuICAgICAgICAgICAgaWQ6XHQnMCcsXG4gICAgICAgICAgICBtYXhid1x0OjAsXG4gICAgICAgICAgICBtYXhpb3BzOlx0MCxcbiAgICAgICAgICAgIG5hbWU6XHQndm9sMicsXG4gICAgICAgICAgICByZW1haW46XHQxMDczNzQxODI0MCxcbiAgICAgICAgICAgIHN0YXR1czpcdCdNb3VudGVkJyxcbiAgICAgICAgICAgIHRvdGFsOlx0MTA3Mzc0MTgyNDAsXG4gICAgICAgICAgICBpcDpcdCcxMC4xLjExLjkxJyxcbiAgICAgICAgICAgIHBvcnQ6XHQnTkEnLFxuICAgICAgICAgICAgc3VibnFuOlx0J05BJyxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uIDogXCJcIixcdFxuICAgICAgICAgICAgdW5pdDpcdCdHQicsXG4gICAgICAgICAgICBzaXplOlx0JzEwJyxcbiAgICAgICAgICAgIHVzZWRzcGFjZTowXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICAgICk7XG4gICAgICAgIHJlbmRlckNvbXBvbmVudCgpO1xuICAgICAgICBjb25zdCB7IGdldEJ5VGV4dCB9ID0gd3JhcHBlcjtcbiAgICAgICAgY29uc3QgaG9zdEVsZW1lbnQgPSBhd2FpdCB3YWl0Rm9yRWxlbWVudCgoKSA9PiBnZXRCeVRleHQoXCJ2b2wyXCIpKTtcbiAgICAgICAgZXhwZWN0KGhvc3RFbGVtZW50KS50b0JlRGVmaW5lZCgpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KFwic2hvdWxkIGRpc3BsYXkgYWxlcnRzXCIsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgbW9jayA9IG5ldyBNb2NrQWRhcHRlcihheGlvcyk7XG4gICAgICAgIG1vY2sub25HZXQoYC9hcGkvdjEuMC9nZXRfYWxlcnRfaW5mb2ApXG4gICAgICAgICAgLnJlcGx5KDIwMCx7XG4gICAgICAgICAgICBhbGVydHM6IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRpbWU6IDEwNDI1Njc4MixcbiAgICAgICAgICAgICAgICBsZXZlbDogJ0NSSVRJQ0FMJyxcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnQ1BVIEFsZXJ0JyxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMTAsXG4gICAgICAgICAgICAgICAgaG9zdDogJ2lCb0YnXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB0aW1lOiAxMDQyNTY3ODMsXG4gICAgICAgICAgICAgICAgbGV2ZWw6ICdOT1JNQUwnLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdpQm9GIEFsZXJ0JyxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMTAsXG4gICAgICAgICAgICAgICAgaG9zdDogJ2lCb0YnXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgICB9KTtcbiAgICAgICAgcmVuZGVyQ29tcG9uZW50KCk7XG4gICAgICAgIGNvbnN0IHsgZ2V0QnlUZXh0IH0gPSB3cmFwcGVyO1xuICAgICAgICBjb25zdCBob3N0RWxlbWVudDEgPSBhd2FpdCB3YWl0Rm9yRWxlbWVudCgoKSA9PiBnZXRCeVRleHQoXCJDUFUgQWxlcnRcIikpO1xuICAgICAgICBleHBlY3QoaG9zdEVsZW1lbnQxKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBjb25zdCBob3N0RWxlbWVudDIgPSBhd2FpdCB3YWl0Rm9yRWxlbWVudCgoKSA9PiBnZXRCeVRleHQoXCJpQm9GIEFsZXJ0XCIpKTtcbiAgICAgICAgZXhwZWN0KGhvc3RFbGVtZW50MikudG9CZURlZmluZWQoKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHJlbmRlciBidXR0b24gb24gcmVzaXplJywgKCkgPT4ge1xuICAgICAgICAvLyBDaGFuZ2UgdGhlIHZpZXdwb3J0IHRvIDUwMHB4LlxuICAgICAgICBnbG9iYWwuaW5uZXJXaWR0aCA9IDUwMDtcblxuICAgICAgICAvLyBUcmlnZ2VyIHRoZSB3aW5kb3cgcmVzaXplIGV2ZW50LlxuICAgICAgICBnbG9iYWwuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3Jlc2l6ZScpKTtcblxuICAgICAgICByZW5kZXJDb21wb25lbnQoKTtcbiAgICAgICAgY29uc3QgeyBnZXRCeVRlc3RJZCB9ID0gd3JhcHBlcjtcbiAgICAgICAgZXhwZWN0KGdldEJ5VGVzdElkKFwic2lkZWJhci10b2dnbGVcIikpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgIGZpcmVFdmVudC5jbGljayhnZXRCeVRlc3RJZChcInNpZGViYXItdG9nZ2xlXCIpKTtcbiAgICAgICAgZXhwZWN0KGdldEJ5VGVzdElkKFwiaGVscC1saW5rXCIpKS50b0hhdmVUZXh0Q29udGVudChcIkhlbHBcIik7XG4gICAgICB9KTtcblxuICAgICAgaXQoXCJzaG91bGQgZGlzcGxheSBpb3BzIHZhbHVlIGFzIHJlY2VpdmVkIGZyb20gQVBJXCIsIGFzeW5jICgpID0+IHtcbiAgICAgICAgamVzdC51c2VGYWtlVGltZXJzKCk7XG4gICAgICAgIGNvbnN0IG1vY2sgPSBuZXcgTW9ja0FkYXB0ZXIoYXhpb3MpO1xuICAgICAgICBtb2NrLm9uR2V0KC9cXC9hcGlcXC92MVxcLjBcXC9wZXJmXFwvYWxsXFw/dHM9Ki8pXG4gICAgICAgICAgLnJlcGx5KDIwMCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBid19yZWFkOiAwLFxuICAgICAgICAgICAgICAgIGJ3X3RvdGFsOiAwLFxuICAgICAgICAgICAgICAgIGJ3X3dyaXRlOiAwLFxuICAgICAgICAgICAgICAgIGlvcHNfcmVhZDogMTU0LFxuICAgICAgICAgICAgICAgIGlvcHNfdG90YWw6IDAsXG4gICAgICAgICAgICAgICAgaW9wc193cml0ZTogMTU0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgKS5vbkFueSgpLnJlcGx5KDIwMCwge30pO1xuICAgICAgICByZW5kZXJDb21wb25lbnQoKTtcbiAgICAgICAgamVzdC5hZHZhbmNlVGltZXJzQnlUaW1lKDIwMDApO1xuICAgICAgICBjb25zdCB7Z2V0QnlUZXN0SWR9ID0gd3JhcHBlcjtcbiAgICAgICAgY29uc3QgcmVhZElvcHNFbGVtZW50ID0gYXdhaXQgd2FpdEZvckVsZW1lbnQoKCkgPT4gZ2V0QnlUZXN0SWQoXCJyZWFkLWlvcHNcIikpO1xuICAgICAgICBleHBlY3QocmVhZElvcHNFbGVtZW50LmlubmVySFRNTCkudG9CZShcIjBcIik7XG4gICAgICB9KTtcbiAgXG59KTsiXX0=