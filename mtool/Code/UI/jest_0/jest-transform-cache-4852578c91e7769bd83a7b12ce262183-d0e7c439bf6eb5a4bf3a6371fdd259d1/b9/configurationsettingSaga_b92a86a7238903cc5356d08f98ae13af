2429a39f6a5781a5fa0aec9c04bb42cb
"use strict";

var _interopRequireWildcard = require("/home/ibof07/pk/ibofmgmt/Code/UI/node_modules/@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("/home/ibof07/pk/ibofmgmt/Code/UI/node_modules/@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.fetchEmailList = fetchEmailList;
exports.updateEmail = updateEmail;
exports.toggleActiveStatus = toggleActiveStatus;
exports.deleteEmailIds = deleteEmailIds;
exports.sendEmail = sendEmail;
exports.testEmail = testEmail;
exports.getIbofOSTimeInterval = getIbofOSTimeInterval;
exports.setIbofOSTimeInterval = setIbofOSTimeInterval;
exports.configurationsettingWatcher = configurationsettingWatcher;

var _defineProperty2 = _interopRequireDefault(require("/home/ibof07/pk/ibofmgmt/Code/UI/node_modules/@babel/runtime/helpers/defineProperty"));

var _axios = _interopRequireDefault(require("axios"));

var _effects = require("redux-saga/effects");

var actionTypes = _interopRequireWildcard(require("../store/actions/actionTypes"));

var actionCreators = _interopRequireWildcard(require("../store/actions/exportActionCreators"));

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function* fetchEmailList() {
  try {
    const response = yield (0, _effects.call)([_axios.default, _axios.default.get], '/api/v1.0/get_email_ids/', {
      headers: {
        Accept: 'application/json',
        'Content-Type': 'application/json',
        'x-access-token': localStorage.getItem('token')
      }
    });
    const result = response.data;
    const emailList = [];

    if (result) {
      result.forEach(email => {
        emailList.push(_objectSpread({}, email, {
          selected: false,
          edit: false
        }));
      });
    }

    yield (0, _effects.put)(actionCreators.fetchEmailList(emailList));
  } catch (error) {
    ;
  }
}

function* updateEmail(action) {
  try {
    const response = yield (0, _effects.call)([_axios.default, _axios.default.post], '/api/v1.0/update_email/', action.payload, {
      headers: {
        Accept: 'application/json',
        'Content-Type': 'application/json',
        'x-access-token': localStorage.getItem('token')
      }
    });
    const status = response.status;

    if (status === 200) {
      yield fetchEmailList();
    }
  } catch (error) {//  console.log(error);
  }
}

function* toggleActiveStatus(action) {
  try {
    yield (0, _effects.call)([_axios.default, _axios.default.post], '/api/v1.0/toggle_email_status/', action.payload, {
      headers: {
        Accept: 'application/json',
        'Content-Type': 'application/json',
        'x-access-token': localStorage.getItem('token')
      }
    });
    yield fetchEmailList();
  } catch (error) {
    yield fetchEmailList();
  }
}

function* deleteEmailIds(action) {
  try {
    const response = yield (0, _effects.call)([_axios.default, _axios.default.post], '/api/v1.0/delete_emailids/', action.payload, {
      headers: {
        Accept: 'application/json',
        'Content-Type': 'application/json',
        'x-access-token': localStorage.getItem('token')
      }
    });
    const status = response.status;

    if (status === 200) {
      const payload = {
        alertOpen: true,
        istypealert: true,
        alerttype: 'info',
        alerttitle: 'Delete Email',
        alertdescription: 'Email ID deleted successfully'
      };
      yield (0, _effects.put)(actionCreators.setAlertBox(payload));
      yield fetchEmailList();
    }
  } catch (error) {
    const payload = {
      alertOpen: true,
      istypealert: true,
      alerttype: 'alert',
      alerttitle: 'Delete Email',
      alertdescription: 'Error in deleting email id'
    };
    yield (0, _effects.put)(actionCreators.setAlertBox(payload));
  }
}

function* sendEmail(action) {
  try {
    const response = yield (0, _effects.call)([_axios.default, _axios.default.post], '/api/v1.0/send_email/', action.payload, {
      headers: {
        Accept: 'application/json',
        'Content-Type': 'application/json',
        'x-access-token': localStorage.getItem('token')
      }
    });
    const status = response.status;
    document.getElementsByTagName('body')[0].style.cursor = 'default';

    if (status === 200) {
      const payload = {
        alertOpen: true,
        istypealert: true,
        alerttype: 'info',
        alerttitle: 'Send Email',
        alertdescription: 'Email sent successfully'
      };
      yield (0, _effects.put)(actionCreators.setAlertBox(payload));
    }
  } catch (error) {
    document.getElementsByTagName('body')[0].style.cursor = 'default';
    const payload = {
      alertOpen: true,
      istypealert: true,
      alerttype: 'alert',
      alerttitle: 'Send Email',
      alertdescription: 'Email sending failed'
    };
    yield (0, _effects.put)(actionCreators.setAlertBox(payload));
  }
}

function* testEmail(action) {
  try {
    const response = yield (0, _effects.call)([_axios.default, _axios.default.post], '/api/v1.0/test_smtpserver/', action.payload, {
      headers: {
        Accept: 'application/json',
        'Content-Type': 'application/json',
        'x-access-token': localStorage.getItem('token')
      }
    });
    const status = response.status;
    document.getElementsByTagName('body')[0].style.cursor = 'default';

    if (status === 200) {
      yield (0, _effects.put)(actionCreators.changeSmtpServer());
      const payload = {
        alertOpen: true,
        istypealert: true,
        alerttype: 'info',
        alerttitle: 'Test SMTP Server',
        alertdescription: 'SMTP server is working'
      };
      yield (0, _effects.put)(actionCreators.setAlertBox(payload));
    }
  } catch (error) {
    document.getElementsByTagName('body')[0].style.cursor = 'default';
    const payload = {
      alertOpen: true,
      istypealert: true,
      alerttype: 'alert',
      alerttitle: 'Test SMTP Server',
      alertdescription: 'SMTP server is not working'
    };
    yield (0, _effects.put)(actionCreators.setAlertBox(payload));
  }
}

function* downloadLogs(action) {
  try {
    const response = yield (0, _effects.call)([_axios.default, _axios.default.get], '/api/v1.0/download_logs', {
      headers: {
        'x-access-token': localStorage.getItem('token')
      },
      params: action.payload,
      responseType: 'blob'
    });
    const status = response.status;

    if (status === 200) {
      const url = window.URL.createObjectURL(new Blob([response.data]));
      const link = document.createElement('a');
      link.href = url;
      link.setAttribute('download', 'log.zip'); // 3. Append to html page

      document.body.appendChild(link); // 4. Force download

      link.click(); // 5. Clean up and remove the link

      link.parentNode.removeChild(link);
    }
  } catch (error) {
    ;
  }
}

function* getIbofOSTimeInterval() {
  try {
    const response = yield (0, _effects.call)([_axios.default, _axios.default.get], '/api/v1.0/get_ibofos_time_interval', {
      headers: {
        Accept: 'application/json',
        'Content-Type': 'application/json',
        'x-access-token': localStorage.getItem('token')
      }
    });
    const result = response.data;

    if (result) {
      yield (0, _effects.put)(actionCreators.setIbofOSTimeInterval(result));
    } else yield (0, _effects.put)(actionCreators.setIbofOSTimeInterval(4)); // Default Value should be 4 seconds

  } catch (error) {
    ;
  }
}

function* setIbofOSTimeInterval(action) {
  try {
    yield (0, _effects.call)([_axios.default, _axios.default.post], '/api/v1.0/set_ibofos_time_interval', action.payload, {
      headers: {
        Accept: 'application/json',
        'Content-Type': 'application/json',
        'x-access-token': localStorage.getItem('token')
      }
    });
    yield getIbofOSTimeInterval();
  } catch (error) {
    yield getIbofOSTimeInterval();
  }
}

function* configurationsettingWatcher() {
  yield (0, _effects.takeEvery)(actionTypes.SAGA_FETCH_EMAIL_LIST, fetchEmailList);
  yield (0, _effects.takeEvery)(actionTypes.SAGA_UPDATE_EMAIL, updateEmail);
  yield (0, _effects.takeEvery)(actionTypes.SAGA_TOGGLE_ACTIVE_STATUS, toggleActiveStatus);
  yield (0, _effects.takeEvery)(actionTypes.SAGA_SEND_EMAIL, sendEmail);
  yield (0, _effects.takeEvery)(actionTypes.SAGA_TEST_EMAIL, testEmail);
  yield (0, _effects.takeEvery)(actionTypes.SAGA_DELETE_EMAIL_IDS, deleteEmailIds);
  yield (0, _effects.takeEvery)(actionTypes.SAGA_DOWNLOAD_LOGS, downloadLogs);
  yield (0, _effects.takeEvery)(actionTypes.SAGA_GET_IBOFOS_TIME_INTERVAL, getIbofOSTimeInterval);
  yield (0, _effects.takeEvery)(actionTypes.SAGA_SET_IBOFOS_TIME_INTERVAL, setIbofOSTimeInterval);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbmZpZ3VyYXRpb25zZXR0aW5nU2FnYS5qcyJdLCJuYW1lcyI6WyJmZXRjaEVtYWlsTGlzdCIsInJlc3BvbnNlIiwiYXhpb3MiLCJnZXQiLCJoZWFkZXJzIiwiQWNjZXB0IiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsInJlc3VsdCIsImRhdGEiLCJlbWFpbExpc3QiLCJmb3JFYWNoIiwiZW1haWwiLCJwdXNoIiwic2VsZWN0ZWQiLCJlZGl0IiwiYWN0aW9uQ3JlYXRvcnMiLCJlcnJvciIsInVwZGF0ZUVtYWlsIiwiYWN0aW9uIiwicG9zdCIsInBheWxvYWQiLCJzdGF0dXMiLCJ0b2dnbGVBY3RpdmVTdGF0dXMiLCJkZWxldGVFbWFpbElkcyIsImFsZXJ0T3BlbiIsImlzdHlwZWFsZXJ0IiwiYWxlcnR0eXBlIiwiYWxlcnR0aXRsZSIsImFsZXJ0ZGVzY3JpcHRpb24iLCJzZXRBbGVydEJveCIsInNlbmRFbWFpbCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJzdHlsZSIsImN1cnNvciIsInRlc3RFbWFpbCIsImNoYW5nZVNtdHBTZXJ2ZXIiLCJkb3dubG9hZExvZ3MiLCJwYXJhbXMiLCJyZXNwb25zZVR5cGUiLCJ1cmwiLCJ3aW5kb3ciLCJVUkwiLCJjcmVhdGVPYmplY3RVUkwiLCJCbG9iIiwibGluayIsImNyZWF0ZUVsZW1lbnQiLCJocmVmIiwic2V0QXR0cmlidXRlIiwiYm9keSIsImFwcGVuZENoaWxkIiwiY2xpY2siLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJnZXRJYm9mT1NUaW1lSW50ZXJ2YWwiLCJzZXRJYm9mT1NUaW1lSW50ZXJ2YWwiLCJjb25maWd1cmF0aW9uc2V0dGluZ1dhdGNoZXIiLCJhY3Rpb25UeXBlcyIsIlNBR0FfRkVUQ0hfRU1BSUxfTElTVCIsIlNBR0FfVVBEQVRFX0VNQUlMIiwiU0FHQV9UT0dHTEVfQUNUSVZFX1NUQVRVUyIsIlNBR0FfU0VORF9FTUFJTCIsIlNBR0FfVEVTVF9FTUFJTCIsIlNBR0FfREVMRVRFX0VNQUlMX0lEUyIsIlNBR0FfRE9XTkxPQURfTE9HUyIsIlNBR0FfR0VUX0lCT0ZPU19USU1FX0lOVEVSVkFMIiwiU0FHQV9TRVRfSUJPRk9TX1RJTUVfSU5URVJWQUwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQTBCQTs7QUFDQTs7QUFDQTs7QUFDQTs7Ozs7O0FBRU8sVUFBVUEsY0FBVixHQUEyQjtBQUNoQyxNQUFJO0FBQ0YsVUFBTUMsUUFBUSxHQUFHLE1BQU0sbUJBQUssQ0FBQ0MsY0FBRCxFQUFRQSxlQUFNQyxHQUFkLENBQUwsRUFBeUIsMEJBQXpCLEVBQXFEO0FBQzFFQyxNQUFBQSxPQUFPLEVBQUU7QUFDUEMsUUFBQUEsTUFBTSxFQUFFLGtCQUREO0FBRVAsd0JBQWdCLGtCQUZUO0FBR1AsMEJBQWtCQyxZQUFZLENBQUNDLE9BQWIsQ0FBcUIsT0FBckI7QUFIWDtBQURpRSxLQUFyRCxDQUF2QjtBQVFBLFVBQU1DLE1BQU0sR0FBR1AsUUFBUSxDQUFDUSxJQUF4QjtBQUNBLFVBQU1DLFNBQVMsR0FBRyxFQUFsQjs7QUFDQSxRQUFJRixNQUFKLEVBQVk7QUFDVkEsTUFBQUEsTUFBTSxDQUFDRyxPQUFQLENBQWVDLEtBQUssSUFBSTtBQUN0QkYsUUFBQUEsU0FBUyxDQUFDRyxJQUFWLG1CQUNLRCxLQURMO0FBRUVFLFVBQUFBLFFBQVEsRUFBRSxLQUZaO0FBR0VDLFVBQUFBLElBQUksRUFBRTtBQUhSO0FBS0QsT0FORDtBQU9EOztBQUNELFVBQU0sa0JBQUlDLGNBQWMsQ0FBQ2hCLGNBQWYsQ0FBOEJVLFNBQTlCLENBQUosQ0FBTjtBQUNELEdBckJELENBcUJFLE9BQU9PLEtBQVAsRUFBYztBQUNkO0FBQ0Q7QUFDRjs7QUFFTSxVQUFVQyxXQUFWLENBQXNCQyxNQUF0QixFQUE4QjtBQUNuQyxNQUFJO0FBQ0YsVUFBTWxCLFFBQVEsR0FBRyxNQUFNLG1CQUNyQixDQUFDQyxjQUFELEVBQVFBLGVBQU1rQixJQUFkLENBRHFCLEVBRXJCLHlCQUZxQixFQUdy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QXdDO0FBQzdDLFFBQU0sd0JBQVVDLFdBQVcsQ0FBQ0MscUJBQXRCLEVBQTZDM0QsY0FBN0MsQ0FBTjtBQUNBLFFBQU0sd0JBQVUwRCxXQUFXLENBQUNFLGlCQUF0QixFQUF5QzFDLFdBQXpDLENBQU47QUFDQSxRQUFNLHdCQUFVd0MsV0FBVyxDQUFDRyx5QkFBdEIsRUFBaUR0QyxrQkFBakQsQ0FBTjtBQUNBLFFBQU0sd0JBQVVtQyxXQUFXLENBQUNJLGVBQXRCLEVBQXVDL0IsU0FBdkMsQ0FBTjtBQUNBLFFBQU0sd0JBQVUyQixXQUFXLENBQUNLLGVBQXRCLEVBQXVDM0IsU0FBdkMsQ0FBTjtBQUNBLFFBQU0sd0JBQVVzQixXQUFXLENBQUNNLHFCQUF0QixFQUE2Q3hDLGNBQTdDLENBQU47QUFDQSxRQUFNLHdCQUFVa0MsV0FBVyxDQUFDTyxrQkFBdEIsRUFBMEMzQixZQUExQyxDQUFOO0FBQ0EsUUFBTSx3QkFBVW9CLFdBQVcsQ0FBQ1EsNkJBQXRCLEVBQXFEWCxxQkFBckQsQ0FBTjtBQUNBLFFBQU0sd0JBQVVHLFdBQVcsQ0FBQ1MsNkJBQXRCLEVBQXFEWCxxQkFBckQsQ0FBTjtBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC9cbi8gICAgICAgICAgICAgICBDT1BZUklHSFQgKGMpIDIwMTkgU0FNU1VORyBFTEVDVFJPTklDUyBDTy4sIExURC4gICAgICAgICAgICAgICAgICAgICAgL1xuLyAgICAgICAgICAgICAgICAgICAgICAgICAgQUxMIFJJR0hUUyBSRVNFUlZFRCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvXG4vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC9cbi8gICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkIHRvIGxpY2Vuc2VlcyBvZiBTYW1zdW5nIEVsZWN0cm9uaWNzIENvLiwgTHRkLiAgICAgICAgL1xuLyAgIHByb2R1Y3RzIHRvIHVzZSBvciBhYnN0cmFjdCB0aGlzIGNvbXB1dGVyIHByb2dyYW0gZm9yIHRoZSBzb2xlIHB1cnBvc2Ugb2YgICAgICAgICAvXG4vICAgaW1wbGVtZW50aW5nIGEgcHJvZHVjdCBiYXNlZCBvbiBTYW1zdW5nIEVsZWN0cm9uaWNzIENvLiwgTHRkLiBwcm9kdWN0cy4gICAgICAgICAgIC9cbi8gICBObyBvdGhlciByaWdodHMgdG8gcmVwcm9kdWNlLCB1c2UsIG9yIGRpc3NlbWluYXRlIHRoaXMgY29tcHV0ZXIgcHJvZ3JhbSwgICAgICAgICAgL1xuLyAgIHdoZXRoZXIgaW4gcGFydCBvciBpbiB3aG9sZSwgYXJlIGdyYW50ZWQuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvIFxuLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvXG4vICAgU2Ftc3VuZyBFbGVjdHJvbmljcyBDby4sIEx0ZC4gbWFrZXMgbm8gcmVwcmVzZW50YXRpb24gb3Igd2FycmFudGllcyB3aXRoICAgICAgICAgIC9cbi8gICByZXNwZWN0IHRvIHRoZSBwZXJmb3JtYW5jZSBvZiB0aGlzIGNvbXB1dGVyIHByb2dyYW0sIGFuZCBzcGVjaWZpY2FsbHkgZGlzY2xhaW1zICAgL1xuLyAgIGFueSByZXNwb25zaWJpbGl0eSBmb3IgYW55IGRhbWFnZXMsIHNwZWNpYWwgb3IgY29uc2VxdWVudGlhbCwgY29ubmVjdGVkICAgICAgICAgICAvXG4vICAgd2l0aCB0aGUgdXNlIG9mIHRoaXMgcHJvZ3JhbS4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC9cbi8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgL1xuLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0vXG5cbkRFU0NSSVBUSU9OOiA8Q29udGFpbnMgR2VuZXJhdG9yIEZ1bmN0aW9ucyBmb3IgQ29uZmlndXJhdGlvbiBjb250YWluZXI+ICpcbkBOQU1FIDogY29uZmlndXJhdGlvbnNldHRpbmdTYWdhLmpzXG5AQVVUSE9SUzogUGFsYWsgS2Fwb29yIFxuQFZlcnNpb24gOiAxLjAgKlxuQFJFVklTSU9OIEhJU1RPUllcblswOC8yMi8yMDE5XSBbUGFsYWtdIDogUHJvdG90eXBpbmcuLi4uLi4uLi4uLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiovXG5cbmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7XG5pbXBvcnQgeyBjYWxsLCB0YWtlRXZlcnksIHB1dCB9IGZyb20gJ3JlZHV4LXNhZ2EvZWZmZWN0cyc7XG5pbXBvcnQgKiBhcyBhY3Rpb25UeXBlcyBmcm9tICcuLi9zdG9yZS9hY3Rpb25zL2FjdGlvblR5cGVzJztcbmltcG9ydCAqIGFzIGFjdGlvbkNyZWF0b3JzIGZyb20gJy4uL3N0b3JlL2FjdGlvbnMvZXhwb3J0QWN0aW9uQ3JlYXRvcnMnO1xuXG5leHBvcnQgZnVuY3Rpb24qIGZldGNoRW1haWxMaXN0KCkge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0geWllbGQgY2FsbChbYXhpb3MsIGF4aW9zLmdldF0sICcvYXBpL3YxLjAvZ2V0X2VtYWlsX2lkcy8nLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIEFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAneC1hY2Nlc3MtdG9rZW4nOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKSxcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IHJlc3BvbnNlLmRhdGE7XG4gICAgY29uc3QgZW1haWxMaXN0ID0gW107XG4gICAgaWYgKHJlc3VsdCkge1xuICAgICAgcmVzdWx0LmZvckVhY2goZW1haWwgPT4ge1xuICAgICAgICBlbWFpbExpc3QucHVzaCh7XG4gICAgICAgICAgLi4uZW1haWwsXG4gICAgICAgICAgc2VsZWN0ZWQ6IGZhbHNlLFxuICAgICAgICAgIGVkaXQ6IGZhbHNlLFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICB5aWVsZCBwdXQoYWN0aW9uQ3JlYXRvcnMuZmV0Y2hFbWFpbExpc3QoZW1haWxMaXN0KSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiogdXBkYXRlRW1haWwoYWN0aW9uKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSB5aWVsZCBjYWxsKFxuICAgICAgW2F4aW9zLCBheGlvcy5wb3N0XSxcbiAgICAgICcvYXBpL3YxLjAvdXBkYXRlX2VtYWlsLycsXG4gICAgICBhY3Rpb24ucGF5bG9hZCwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgJ3gtYWNjZXNzLXRva2VuJzogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJyksXG4gICAgICB9XG4gICAgfVxuICAgICk7XG4gICAgY29uc3QgeyBzdGF0dXMgfSA9IHJlc3BvbnNlO1xuICAgIGlmIChzdGF0dXMgPT09IDIwMCkge1xuICAgICAgeWllbGQgZmV0Y2hFbWFpbExpc3QoKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgLy8gIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24qIHRvZ2dsZUFjdGl2ZVN0YXR1cyhhY3Rpb24pIHtcbiAgdHJ5IHtcbiAgICB5aWVsZCBjYWxsKFxuICAgICAgW2F4aW9zLCBheGlvcy5wb3N0XSxcbiAgICAgICcvYXBpL3YxLjAvdG9nZ2xlX2VtYWlsX3N0YXR1cy8nLFxuICAgICAgYWN0aW9uLnBheWxvYWQsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgQWNjZXB0OiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICd4LWFjY2Vzcy10b2tlbic6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpLFxuICAgICAgfVxuICAgIH1cbiAgICApO1xuICAgIHlpZWxkIGZldGNoRW1haWxMaXN0KCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgeWllbGQgZmV0Y2hFbWFpbExpc3QoKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24qIGRlbGV0ZUVtYWlsSWRzKGFjdGlvbikge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0geWllbGQgY2FsbChcbiAgICAgIFtheGlvcywgYXhpb3MucG9zdF0sXG4gICAgICAnL2FwaS92MS4wL2RlbGV0ZV9lbWFpbGlkcy8nLFxuICAgICAgYWN0aW9uLnBheWxvYWQsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgQWNjZXB0OiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICd4LWFjY2Vzcy10b2tlbic6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpLFxuICAgICAgfVxuICAgIH1cbiAgICApO1xuICAgIGNvbnN0IHsgc3RhdHVzIH0gPSByZXNwb25zZTtcbiAgICBpZiAoc3RhdHVzID09PSAyMDApIHtcbiAgICAgIGNvbnN0IHBheWxvYWQgPSB7XG4gICAgICAgIGFsZXJ0T3BlbjogdHJ1ZSxcbiAgICAgICAgaXN0eXBlYWxlcnQ6IHRydWUsXG4gICAgICAgIGFsZXJ0dHlwZTogJ2luZm8nLFxuICAgICAgICBhbGVydHRpdGxlOiAnRGVsZXRlIEVtYWlsJyxcbiAgICAgICAgYWxlcnRkZXNjcmlwdGlvbjogJ0VtYWlsIElEIGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICAgIH07XG4gICAgICB5aWVsZCBwdXQoYWN0aW9uQ3JlYXRvcnMuc2V0QWxlcnRCb3gocGF5bG9hZCkpO1xuICAgICAgeWllbGQgZmV0Y2hFbWFpbExpc3QoKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc3QgcGF5bG9hZCA9IHtcbiAgICAgIGFsZXJ0T3BlbjogdHJ1ZSxcbiAgICAgIGlzdHlwZWFsZXJ0OiB0cnVlLFxuICAgICAgYWxlcnR0eXBlOiAnYWxlcnQnLFxuICAgICAgYWxlcnR0aXRsZTogJ0RlbGV0ZSBFbWFpbCcsXG4gICAgICBhbGVydGRlc2NyaXB0aW9uOiAnRXJyb3IgaW4gZGVsZXRpbmcgZW1haWwgaWQnLFxuICAgIH07XG4gICAgeWllbGQgcHV0KGFjdGlvbkNyZWF0b3JzLnNldEFsZXJ0Qm94KHBheWxvYWQpKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24qIHNlbmRFbWFpbChhY3Rpb24pIHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IHlpZWxkIGNhbGwoXG4gICAgICBbYXhpb3MsIGF4aW9zLnBvc3RdLFxuICAgICAgJy9hcGkvdjEuMC9zZW5kX2VtYWlsLycsXG4gICAgICBhY3Rpb24ucGF5bG9hZCwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgJ3gtYWNjZXNzLXRva2VuJzogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJyksXG4gICAgICB9XG4gICAgfVxuICAgICk7XG4gICAgY29uc3QgeyBzdGF0dXMgfSA9IHJlc3BvbnNlO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF0uc3R5bGUuY3Vyc29yID0gJ2RlZmF1bHQnO1xuXG4gICAgaWYgKHN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICBjb25zdCBwYXlsb2FkID0ge1xuICAgICAgICBhbGVydE9wZW46IHRydWUsXG4gICAgICAgIGlzdHlwZWFsZXJ0OiB0cnVlLFxuICAgICAgICBhbGVydHR5cGU6ICdpbmZvJyxcbiAgICAgICAgYWxlcnR0aXRsZTogJ1NlbmQgRW1haWwnLFxuICAgICAgICBhbGVydGRlc2NyaXB0aW9uOiAnRW1haWwgc2VudCBzdWNjZXNzZnVsbHknLFxuICAgICAgfTtcbiAgICAgIHlpZWxkIHB1dChhY3Rpb25DcmVhdG9ycy5zZXRBbGVydEJveChwYXlsb2FkKSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF0uc3R5bGUuY3Vyc29yID0gJ2RlZmF1bHQnO1xuICAgIGNvbnN0IHBheWxvYWQgPSB7XG4gICAgICBhbGVydE9wZW46IHRydWUsXG4gICAgICBpc3R5cGVhbGVydDogdHJ1ZSxcbiAgICAgIGFsZXJ0dHlwZTogJ2FsZXJ0JyxcbiAgICAgIGFsZXJ0dGl0bGU6ICdTZW5kIEVtYWlsJyxcbiAgICAgIGFsZXJ0ZGVzY3JpcHRpb246ICdFbWFpbCBzZW5kaW5nIGZhaWxlZCcsXG4gICAgfTtcbiAgICB5aWVsZCBwdXQoYWN0aW9uQ3JlYXRvcnMuc2V0QWxlcnRCb3gocGF5bG9hZCkpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiogdGVzdEVtYWlsKGFjdGlvbikge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0geWllbGQgY2FsbChcbiAgICAgIFtheGlvcywgYXhpb3MucG9zdF0sXG4gICAgICAnL2FwaS92MS4wL3Rlc3Rfc210cHNlcnZlci8nLFxuICAgICAgYWN0aW9uLnBheWxvYWQsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgQWNjZXB0OiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICd4LWFjY2Vzcy10b2tlbic6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpLFxuICAgICAgfVxuICAgIH1cbiAgICApO1xuICAgIGNvbnN0IHsgc3RhdHVzIH0gPSByZXNwb25zZTtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnYm9keScpWzBdLnN0eWxlLmN1cnNvciA9ICdkZWZhdWx0JztcbiAgICBpZiAoc3RhdHVzID09PSAyMDApIHtcbiAgICAgIHlpZWxkIHB1dChhY3Rpb25DcmVhdG9ycy5jaGFuZ2VTbXRwU2VydmVyKCkpO1xuICAgICAgY29uc3QgcGF5bG9hZCA9IHtcbiAgICAgICAgYWxlcnRPcGVuOiB0cnVlLFxuICAgICAgICBpc3R5cGVhbGVydDogdHJ1ZSxcbiAgICAgICAgYWxlcnR0eXBlOiAnaW5mbycsXG4gICAgICAgIGFsZXJ0dGl0bGU6ICdUZXN0IFNNVFAgU2VydmVyJyxcbiAgICAgICAgYWxlcnRkZXNjcmlwdGlvbjogJ1NNVFAgc2VydmVyIGlzIHdvcmtpbmcnLFxuICAgICAgfTtcbiAgICAgIHlpZWxkIHB1dChhY3Rpb25DcmVhdG9ycy5zZXRBbGVydEJveChwYXlsb2FkKSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF0uc3R5bGUuY3Vyc29yID0gJ2RlZmF1bHQnO1xuICAgIGNvbnN0IHBheWxvYWQgPSB7XG4gICAgICBhbGVydE9wZW46IHRydWUsXG4gICAgICBpc3R5cGVhbGVydDogdHJ1ZSxcbiAgICAgIGFsZXJ0dHlwZTogJ2FsZXJ0JyxcbiAgICAgIGFsZXJ0dGl0bGU6ICdUZXN0IFNNVFAgU2VydmVyJyxcbiAgICAgIGFsZXJ0ZGVzY3JpcHRpb246ICdTTVRQIHNlcnZlciBpcyBub3Qgd29ya2luZycsXG4gICAgfTtcbiAgICB5aWVsZCBwdXQoYWN0aW9uQ3JlYXRvcnMuc2V0QWxlcnRCb3gocGF5bG9hZCkpO1xuICB9XG59XG5cbmZ1bmN0aW9uKiBkb3dubG9hZExvZ3MoYWN0aW9uKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSB5aWVsZCBjYWxsKFxuICAgICAgW2F4aW9zLCBheGlvcy5nZXRdLFxuICAgICAgJy9hcGkvdjEuMC9kb3dubG9hZF9sb2dzJywge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICAneC1hY2Nlc3MtdG9rZW4nOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKSxcbiAgICAgIH0sXG4gICAgICBwYXJhbXM6IGFjdGlvbi5wYXlsb2FkLFxuICAgICAgcmVzcG9uc2VUeXBlOiAnYmxvYidcbiAgICB9XG4gICAgKTtcbiAgICBjb25zdCB7IHN0YXR1cyB9ID0gcmVzcG9uc2U7XG4gICAgaWYgKHN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICBjb25zdCB1cmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgQmxvYihbcmVzcG9uc2UuZGF0YV0pKTtcbiAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICBsaW5rLmhyZWYgPSB1cmw7XG4gICAgICBsaW5rLnNldEF0dHJpYnV0ZSgnZG93bmxvYWQnLCAnbG9nLnppcCcpO1xuICAgICAgLy8gMy4gQXBwZW5kIHRvIGh0bWwgcGFnZVxuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsaW5rKTtcbiAgICAgIC8vIDQuIEZvcmNlIGRvd25sb2FkXG4gICAgICBsaW5rLmNsaWNrKCk7XG4gICAgICAvLyA1LiBDbGVhbiB1cCBhbmQgcmVtb3ZlIHRoZSBsaW5rXG4gICAgICBsaW5rLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobGluayk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIDtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24qIGdldElib2ZPU1RpbWVJbnRlcnZhbCgpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IHlpZWxkIGNhbGwoW2F4aW9zLCBheGlvcy5nZXRdLCAnL2FwaS92MS4wL2dldF9pYm9mb3NfdGltZV9pbnRlcnZhbCcsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgQWNjZXB0OiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICd4LWFjY2Vzcy10b2tlbic6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpLFxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gcmVzcG9uc2UuZGF0YTtcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICB5aWVsZCBwdXQoYWN0aW9uQ3JlYXRvcnMuc2V0SWJvZk9TVGltZUludGVydmFsKHJlc3VsdCkpO1xuICAgIH1cbiAgICBlbHNlIHlpZWxkIHB1dChhY3Rpb25DcmVhdG9ycy5zZXRJYm9mT1NUaW1lSW50ZXJ2YWwoNCkpOyAvLyBEZWZhdWx0IFZhbHVlIHNob3VsZCBiZSA0IHNlY29uZHNcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICA7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uKiBzZXRJYm9mT1NUaW1lSW50ZXJ2YWwoYWN0aW9uKSB7XG4gIHRyeSB7XG4gICAgeWllbGQgY2FsbChcbiAgICAgIFtheGlvcywgYXhpb3MucG9zdF0sXG4gICAgICAnL2FwaS92MS4wL3NldF9pYm9mb3NfdGltZV9pbnRlcnZhbCcsXG4gICAgICBhY3Rpb24ucGF5bG9hZCwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgJ3gtYWNjZXNzLXRva2VuJzogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJyksXG4gICAgICB9XG4gICAgfVxuICAgICk7XG4gICAgeWllbGQgZ2V0SWJvZk9TVGltZUludGVydmFsKCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgeWllbGQgZ2V0SWJvZk9TVGltZUludGVydmFsKCk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uKiBjb25maWd1cmF0aW9uc2V0dGluZ1dhdGNoZXIoKSB7XG4gIHlpZWxkIHRha2VFdmVyeShhY3Rpb25UeXBlcy5TQUdBX0ZFVENIX0VNQUlMX0xJU1QsIGZldGNoRW1haWxMaXN0KTtcbiAgeWllbGQgdGFrZUV2ZXJ5KGFjdGlvblR5cGVzLlNBR0FfVVBEQVRFX0VNQUlMLCB1cGRhdGVFbWFpbCk7XG4gIHlpZWxkIHRha2VFdmVyeShhY3Rpb25UeXBlcy5TQUdBX1RPR0dMRV9BQ1RJVkVfU1RBVFVTLCB0b2dnbGVBY3RpdmVTdGF0dXMpO1xuICB5aWVsZCB0YWtlRXZlcnkoYWN0aW9uVHlwZXMuU0FHQV9TRU5EX0VNQUlMLCBzZW5kRW1haWwpO1xuICB5aWVsZCB0YWtlRXZlcnkoYWN0aW9uVHlwZXMuU0FHQV9URVNUX0VNQUlMLCB0ZXN0RW1haWwpO1xuICB5aWVsZCB0YWtlRXZlcnkoYWN0aW9uVHlwZXMuU0FHQV9ERUxFVEVfRU1BSUxfSURTLCBkZWxldGVFbWFpbElkcyk7XG4gIHlpZWxkIHRha2VFdmVyeShhY3Rpb25UeXBlcy5TQUdBX0RPV05MT0FEX0xPR1MsIGRvd25sb2FkTG9ncyk7XG4gIHlpZWxkIHRha2VFdmVyeShhY3Rpb25UeXBlcy5TQUdBX0dFVF9JQk9GT1NfVElNRV9JTlRFUlZBTCwgZ2V0SWJvZk9TVGltZUludGVydmFsKTtcbiAgeWllbGQgdGFrZUV2ZXJ5KGFjdGlvblR5cGVzLlNBR0FfU0VUX0lCT0ZPU19USU1FX0lOVEVSVkFMLCBzZXRJYm9mT1NUaW1lSW50ZXJ2YWwpXG59XG4iXX0=