38fb067b6263b4d81f63912a675fbbad
"use strict";

var _interopRequireWildcard = require("/home/ibof07/pk/ibofmgmt/Code/UI/node_modules/@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("/home/ibof07/pk/ibofmgmt/Code/UI/node_modules/@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getIbofOsLogs = getIbofOsLogs;
exports.setLiveLogsDb = setLiveLogsDb;
exports.getLiveLogsDb = getLiveLogsDb;
exports.logManagementWatcher = logManagementWatcher;

var _defineProperty2 = _interopRequireDefault(require("/home/ibof07/pk/ibofmgmt/Code/UI/node_modules/@babel/runtime/helpers/defineProperty"));

var _axios = _interopRequireDefault(require("axios"));

var _effects = require("redux-saga/effects");

var actionTypes = _interopRequireWildcard(require("../store/actions/actionTypes"));

var actionCreators = _interopRequireWildcard(require("../store/actions/exportActionCreators"));

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function* getIbofOsLogs() {
  try {
    const response = yield (0, _effects.call)([_axios.default, _axios.default.get], `/api/v1.0/get_Ibof_OS_Logs/?ts=${Date.now()}`, {
      headers: {
        Accept: 'application/json',
        'Content-Type': 'application/json',
        'x-access-token': localStorage.getItem('token')
      }
    });
    const result = response.data;

    if (result) {
      const logList = [];
      result.forEach(log => {
        logList.push(_objectSpread({}, log));
      });
      yield (0, _effects.put)(actionCreators.getIbofOsLogs(logList));
    }
  } catch (error) {//  console.log(error);
  }
}

function* setLiveLogsDb(action) {
  try {
    yield (0, _effects.call)([_axios.default, _axios.default.post], '/api/v1.0/set_live_logs/', {
      "liveLogs": action.payload
    }, {
      headers: {
        Accept: 'application/json',
        'Content-Type': 'application/json',
        'x-access-token': localStorage.getItem('token')
      }
    });
    yield (0, _effects.put)(actionCreators.setLiveLogs(action.payload));
  } catch (error) {
    yield (0, _effects.put)(actionCreators.setLiveLogs(action.payload));
  }
}

function* getLiveLogsDb() {
  try {
    const response = yield (0, _effects.call)([_axios.default, _axios.default.get], `/api/v1.0/get_live_logs/?ts=${Date.now()}`, {
      headers: {
        Accept: 'application/json',
        'Content-Type': 'application/json',
        'x-access-token': localStorage.getItem('token')
      }
    });
    const result = response.data;

    if (result) {
      yield (0, _effects.put)(actionCreators.setLiveLogs(result));
    }
  } catch (error) {// console.log(error);
  }
}

function* logManagementWatcher() {
  yield (0, _effects.takeEvery)(actionTypes.SAGA_GET_IBOFOS_LOGS, getIbofOsLogs);
  yield (0, _effects.takeEvery)(actionTypes.SAGA_SET_LIVE_LOGS_DB, setLiveLogsDb);
  yield (0, _effects.takeEvery)(actionTypes.SAGA_GET_LIVE_LOGS_DB, getLiveLogsDb);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ01hbmFnZW1lbnRTYWdhLmpzIl0sIm5hbWVzIjpbImdldElib2ZPc0xvZ3MiLCJyZXNwb25zZSIsImF4aW9zIiwiZ2V0IiwiRGF0ZSIsIm5vdyIsImhlYWRlcnMiLCJBY2NlcHQiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwicmVzdWx0IiwiZGF0YSIsImxvZ0xpc3QiLCJmb3JFYWNoIiwibG9nIiwicHVzaCIsImFjdGlvbkNyZWF0b3JzIiwiZXJyb3IiLCJzZXRMaXZlTG9nc0RiIiwiYWN0aW9uIiwicG9zdCIsInBheWxvYWQiLCJzZXRMaXZlTG9ncyIsImdldExpdmVMb2dzRGIiLCJsb2dNYW5hZ2VtZW50V2F0Y2hlciIsImFjdGlvblR5cGVzIiwiU0FHQV9HRVRfSUJPRk9TX0xPR1MiLCJTQUdBX1NFVF9MSVZFX0xPR1NfREIiLCJTQUdBX0dFVF9MSVZFX0xPR1NfREIiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUEwQkE7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7OztBQUVPLFVBQVVBLGFBQVYsR0FBMEI7QUFDL0IsTUFBSTtBQUNGLFVBQU1DLFFBQVEsR0FBRyxNQUFNLG1CQUFLLENBQUNDLGNBQUQsRUFBUUEsZUFBTUMsR0FBZCxDQUFMLEVBQTBCLGtDQUFpQ0MsSUFBSSxDQUFDQyxHQUFMLEVBQVcsRUFBdEUsRUFBeUU7QUFDOUZDLE1BQUFBLE9BQU8sRUFBRTtBQUNMQyxRQUFBQSxNQUFNLEVBQUUsa0JBREg7QUFFTCx3QkFBZ0Isa0JBRlg7QUFHTCwwQkFBa0JDLFlBQVksQ0FBQ0MsT0FBYixDQUFxQixPQUFyQjtBQUhiO0FBRHFGLEtBQXpFLENBQXZCO0FBUUEsVUFBTUMsTUFBTSxHQUFHVCxRQUFRLENBQUNVLElBQXhCOztBQUNBLFFBQUlELE1BQUosRUFBWTtBQUNWLFlBQU1FLE9BQU8sR0FBRyxFQUFoQjtBQUNBRixNQUFBQSxNQUFNLENBQUNHLE9BQVAsQ0FBZUMsR0FBRyxJQUFJO0FBQ3BCRixRQUFBQSxPQUFPLENBQUNHLElBQVIsbUJBQ0tELEdBREw7QUFHRCxPQUpEO0FBS0EsWUFBTSxrQkFBSUUsY0FBYyxDQUFDaEIsYUFBZixDQUE2QlksT0FBN0IsQ0FBSixDQUFOO0FBQ0Q7QUFDRixHQW5CRCxDQW1CRSxPQUFPSyxLQUFQLEVBQWMsQ0FDZDtBQUNEO0FBQ0Y7O0FBRU0sVUFBVUMsYUFBVixDQUF3QkMsTUFBeEIsRUFBZ0M7QUFFckMsTUFBSTtBQUNELFVBQU0sbUJBQ0wsQ0FBQ2pCLGNBQUQsRUFBUUEsZUFBTWtCLElBQWQsQ0FESyxFQUVMLDBCQUZLLEVBR0w7QUFBQyxrQkFBV0QsTUFBTSxDQUFDRTtBQUFuQixLQUhLLEVBR3dCO0FBQzNCZixNQUFBQSxPQUFPLEVBQUU7QUFDTEMsUUFBQUEsTUFBTSxFQUFFLGtCQURIO0FBRUwsd0JBQWdCLGtCQUZYO0FBR0wsMEJBQWtCQyxZQUFZLENBQUNDLE9BQWIsQ0FBcUIsT0FBckI7QUFIYjtBQURrQixLQUh4QixDQUFOO0FBV0QsVUFBTSxrQkFBSU8sY0FBYyxDQUFDTSxXQUFmLENBQTJCSCxNQUFNLENBQUNFLE9BQWxDLENBQUosQ0FBTjtBQUNELEdBYkQsQ0FhRSxPQUFPSixLQUFQLEVBQWM7QUFDZCxVQUFNLGtCQUFJRCxjQUFjLENBQUNNLFdBQWYsQ0FBMkJILE1BQU0sQ0FBQ0UsT0FBbEMsQ0FBSixDQUFOO0FBQ0Q7QUFDRjs7QUFFTSxVQUFVRSxhQUFWLEdBQTBCO0FBQy9CLE1BQUk7QUFDRixVQUFNdEIsUUFBUSxHQUFHLE1BQU0sbUJBQUssQ0FBQ0MsY0FBRCxFQUFRQSxlQUFNQyxHQUFkLENBQUwsRUFBMEIsK0JBQThCQyxJQUFJLENBQUNDLEdBQUwsRUFBVyxFQUFuRSxFQUFzRTtBQUMzRkMsTUFBQUEsT0FBTyxFQUFFO0FBQ0xDLFFBQUFBLE1BQU0sRUFBRSxrQkFESDtBQUVMLHdCQUFnQixrQkFGWDtBQUdMLDBCQUFrQkMsWUFBWSxDQUFDQyxPQUFiLENBQXFCLE9BQXJCO0FBSGI7QUFEa0YsS0FBdEUsQ0FBdkI7QUFRQSxVQUFNQyxNQUFNLEdBQUdULFFBQVEsQ0FBQ1UsSUFBeEI7O0FBQ0EsUUFBSUQsTUFBSixFQUFZO0FBQ1YsWUFBTSxrQkFBSU0sY0FBYyxDQUFDTSxXQUFmLENBQTJCWixNQUEzQixDQUFKLENBQU47QUFDRDtBQUNGLEdBYkQsQ0FhRSxPQUFPTyxLQUFQLEVBQWMsQ0FDYjtBQUNGO0FBQ0Y7O0FBSU0sVUFBVU8sb0JBQVYsR0FBaUM7QUFDcEMsUUFBTSx3QkFBVUMsV0FBVyxDQUFDQyxvQkFBdEIsRUFBNEMxQixhQUE1QyxDQUFOO0FBQ0EsUUFBTSx3QkFBVXlCLFdBQVcsQ0FBQ0UscUJBQXRCLEVBQTZDVCxhQUE3QyxDQUFOO0FBQ0EsUUFBTSx3QkFBVU8sV0FBVyxDQUFDRyxxQkFBdEIsRUFBNkNMLGFBQTdDLENBQU47QUFDRCIsInNvdXJjZXNDb250ZW50IjpbIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0vXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvXG4vICAgICAgICAgICAgICAgQ09QWVJJR0hUIChjKSAyMDE5IFNBTVNVTkcgRUxFQ1RST05JQ1MgQ08uLCBMVEQuICAgICAgICAgICAgICAgICAgICAgIC9cbi8gICAgICAgICAgICAgICAgICAgICAgICAgIEFMTCBSSUdIVFMgUkVTRVJWRUQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgL1xuLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvXG4vICAgUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCB0byBsaWNlbnNlZXMgb2YgU2Ftc3VuZyBFbGVjdHJvbmljcyBDby4sIEx0ZC4gICAgICAgIC9cbi8gICBwcm9kdWN0cyB0byB1c2Ugb3IgYWJzdHJhY3QgdGhpcyBjb21wdXRlciBwcm9ncmFtIGZvciB0aGUgc29sZSBwdXJwb3NlIG9mICAgICAgICAgL1xuLyAgIGltcGxlbWVudGluZyBhIHByb2R1Y3QgYmFzZWQgb24gU2Ftc3VuZyBFbGVjdHJvbmljcyBDby4sIEx0ZC4gcHJvZHVjdHMuICAgICAgICAgICAvXG4vICAgTm8gb3RoZXIgcmlnaHRzIHRvIHJlcHJvZHVjZSwgdXNlLCBvciBkaXNzZW1pbmF0ZSB0aGlzIGNvbXB1dGVyIHByb2dyYW0sICAgICAgICAgIC9cbi8gICB3aGV0aGVyIGluIHBhcnQgb3IgaW4gd2hvbGUsIGFyZSBncmFudGVkLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyBcbi8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgL1xuLyAgIFNhbXN1bmcgRWxlY3Ryb25pY3MgQ28uLCBMdGQuIG1ha2VzIG5vIHJlcHJlc2VudGF0aW9uIG9yIHdhcnJhbnRpZXMgd2l0aCAgICAgICAgICAvXG4vICAgcmVzcGVjdCB0byB0aGUgcGVyZm9ybWFuY2Ugb2YgdGhpcyBjb21wdXRlciBwcm9ncmFtLCBhbmQgc3BlY2lmaWNhbGx5IGRpc2NsYWltcyAgIC9cbi8gICBhbnkgcmVzcG9uc2liaWxpdHkgZm9yIGFueSBkYW1hZ2VzLCBzcGVjaWFsIG9yIGNvbnNlcXVlbnRpYWwsIGNvbm5lY3RlZCAgICAgICAgICAgL1xuLyAgIHdpdGggdGhlIHVzZSBvZiB0aGlzIHByb2dyYW0uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvXG4vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC9cbi8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tL1xuXG5ERVNDUklQVElPTjogPENvbnRhaW5zIEdlbmVyYXRvciBGdW5jdGlvbnMgZm9yIENvbmZpZ3VyYXRpb24gY29udGFpbmVyPiAqXG5ATkFNRSA6IGxvZ01hbmFnZW1lbnRTYWdhLmpzXG5AQVVUSE9SUzogUGFsYWsgS2Fwb29yIFxuQFZlcnNpb24gOiAxLjAgKlxuQFJFVklTSU9OIEhJU1RPUllcblswOC8yMi8yMDE5XSBbUGFsYWtdIDogUHJvdG90eXBpbmcuLi4uLi4uLi4uLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiovXG5cbmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7XG5pbXBvcnQgeyBjYWxsLCB0YWtlRXZlcnksIHB1dCB9IGZyb20gJ3JlZHV4LXNhZ2EvZWZmZWN0cyc7XG5pbXBvcnQgKiBhcyBhY3Rpb25UeXBlcyBmcm9tICcuLi9zdG9yZS9hY3Rpb25zL2FjdGlvblR5cGVzJztcbmltcG9ydCAqIGFzIGFjdGlvbkNyZWF0b3JzIGZyb20gJy4uL3N0b3JlL2FjdGlvbnMvZXhwb3J0QWN0aW9uQ3JlYXRvcnMnO1xuXG5leHBvcnQgZnVuY3Rpb24qIGdldElib2ZPc0xvZ3MoKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSB5aWVsZCBjYWxsKFtheGlvcywgYXhpb3MuZ2V0XSwgYC9hcGkvdjEuMC9nZXRfSWJvZl9PU19Mb2dzLz90cz0ke0RhdGUubm93KCl9YCwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIEFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgJ3gtYWNjZXNzLXRva2VuJzogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJyksXG4gICAgICB9XG4gIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gcmVzcG9uc2UuZGF0YTtcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICBjb25zdCBsb2dMaXN0ID0gW107XG4gICAgICByZXN1bHQuZm9yRWFjaChsb2cgPT4ge1xuICAgICAgICBsb2dMaXN0LnB1c2goe1xuICAgICAgICAgIC4uLmxvZyxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHlpZWxkIHB1dChhY3Rpb25DcmVhdG9ycy5nZXRJYm9mT3NMb2dzKGxvZ0xpc3QpKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgLy8gIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24qIHNldExpdmVMb2dzRGIoYWN0aW9uKSB7XG4gIFxuICB0cnkge1xuICAgICB5aWVsZCBjYWxsKFxuICAgICAgW2F4aW9zLCBheGlvcy5wb3N0XSxcbiAgICAgICcvYXBpL3YxLjAvc2V0X2xpdmVfbG9ncy8nLFxuICAgICAge1wibGl2ZUxvZ3NcIjphY3Rpb24ucGF5bG9hZH0sIHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgQWNjZXB0OiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgJ3gtYWNjZXNzLXRva2VuJzogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJyksXG4gICAgICAgIH1cbiAgICB9XG4gICAgKTtcbiAgICB5aWVsZCBwdXQoYWN0aW9uQ3JlYXRvcnMuc2V0TGl2ZUxvZ3MoYWN0aW9uLnBheWxvYWQpKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICB5aWVsZCBwdXQoYWN0aW9uQ3JlYXRvcnMuc2V0TGl2ZUxvZ3MoYWN0aW9uLnBheWxvYWQpKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24qIGdldExpdmVMb2dzRGIoKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSB5aWVsZCBjYWxsKFtheGlvcywgYXhpb3MuZ2V0XSwgYC9hcGkvdjEuMC9nZXRfbGl2ZV9sb2dzLz90cz0ke0RhdGUubm93KCl9YCwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIEFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgJ3gtYWNjZXNzLXRva2VuJzogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJyksXG4gICAgICB9XG4gIH0pO1xuXG4gICAgY29uc3QgcmVzdWx0ID0gcmVzcG9uc2UuZGF0YTtcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICB5aWVsZCBwdXQoYWN0aW9uQ3JlYXRvcnMuc2V0TGl2ZUxvZ3MocmVzdWx0KSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgICAvLyBjb25zb2xlLmxvZyhlcnJvcik7XG4gIH1cbn1cblxuXG5cbmV4cG9ydCBmdW5jdGlvbiogbG9nTWFuYWdlbWVudFdhdGNoZXIoKSB7XG4gICAgeWllbGQgdGFrZUV2ZXJ5KGFjdGlvblR5cGVzLlNBR0FfR0VUX0lCT0ZPU19MT0dTLCBnZXRJYm9mT3NMb2dzKTtcbiAgICB5aWVsZCB0YWtlRXZlcnkoYWN0aW9uVHlwZXMuU0FHQV9TRVRfTElWRV9MT0dTX0RCLCBzZXRMaXZlTG9nc0RiKTtcbiAgICB5aWVsZCB0YWtlRXZlcnkoYWN0aW9uVHlwZXMuU0FHQV9HRVRfTElWRV9MT0dTX0RCLCBnZXRMaXZlTG9nc0RiKTtcbiAgfVxuICBcbiJdfQ==