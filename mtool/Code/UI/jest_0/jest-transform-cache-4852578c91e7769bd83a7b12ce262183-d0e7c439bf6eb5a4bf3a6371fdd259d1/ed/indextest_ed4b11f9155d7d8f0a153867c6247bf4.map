{"version":3,"sources":["index.test.js"],"names":["jest","unmock","describe","wrapper","history","store","beforeEach","sagaMiddleware","rootReducers","headerReducer","dashboardReducer","configurationsettingReducer","BMCAuthenticationReducer","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","run","rootSaga","route","initialEntries","renderComponent","i18n","afterEach","cleanup","it","asFragment","expect","toMatchSnapshot","mock","MockAdapter","axios","onGet","Date","now","reply","arraySize","getByTestId","readStorageElement","innerHTML","toBe","host","ip","mac","ipElement","hostElement","macElement","getByText","toBeDefined","id","maxbw","maxiops","name","remain","status","total","port","subnqn","description","unit","size","usedspace","alerts","time","level","message","duration","hostElement1","hostElement2","global","innerWidth","dispatchEvent","Event","fireEvent","click","toHaveTextContent","useFakeTimers","bw_read","bw_total","bw_write","iops_read","iops_total","iops_write","onAny","advanceTimersByTime","readIopsElement"],"mappings":";;AAuBAA,IAAI,CAACC,MAAL,CAAY,OAAZ;;;;AAtBA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAGA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;AAKAC,QAAQ,CAAC,WAAD,EAAc,MAAM;AACxB,MAAIC,OAAJ;AACA,MAAIC,OAAJ;AACA,MAAIC,KAAJ;AAEAC,EAAAA,UAAU,CAAC,MAAM;AACf,UAAMC,cAAc,GAAG,yBAAvB;AACA,UAAMC,YAAY,GAAG,4BAAgB;AACnCC,MAAAA,aAAa,EAAbA,sBADmC;AAEnCC,MAAAA,gBAAgB,EAAhBA,yBAFmC;AAGnCC,MAAAA,2BAA2B,EAA3BA,oCAHmC;AAInCC,MAAAA,wBAAwB,EAAxBA;AAJmC,KAAhB,CAArB;AAMA,UAAMC,gBAAgB,GAAGC,MAAM,CAACC,oCAAP,IAA+CC,cAAxE;AACAX,IAAAA,KAAK,GAAG,wBAAYG,YAAZ,EAAyBK,gBAAgB,CAAC,4BAAgBN,cAAhB,CAAD,CAAzC,CAAR;AACAA,IAAAA,cAAc,CAACU,GAAf,CAAmBC,kBAAnB;AACA,UAAMC,KAAK,GAAG,GAAd;AACAf,IAAAA,OAAO,GAAG,kCAAoB;AAAEgB,MAAAA,cAAc,EAAE,CAACD,KAAD;AAAlB,KAApB,CAAV;AAGD,GAfS,CAAV;;AAkBA,QAAME,eAAe,GAAG,MAAM;AAC1BlB,IAAAA,OAAO,GAAG,oBACR,6BAAC,sBAAD;AAAQ,MAAA,OAAO,EAAEC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACA,6BAAC,6BAAD;AAAiB,MAAA,IAAI,EAAEkB,aAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,6BAAC,oBAAD;AAAU,MAAA,KAAK,EAAEjB,KAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,GADH,EAEE,6BAAC,cAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,CADF,CADA,CADQ,CAAV;AAUH,GAXD;;AAaAkB,EAAAA,SAAS,CAACC,eAAD,CAAT;AAEAC,EAAAA,EAAE,CAAC,kBAAD,EAAqB,MAAM;AAC3BJ,IAAAA,eAAe;AADY,qBAEJlB,OAFI;AAAA,UAEnBuB,UAFmB,YAEnBA,UAFmB;AAG3BC,IAAAA,MAAM,CAACD,UAAU,EAAX,CAAN,CAAqBE,eAArB;AACD,GAJC,CAAF;AAOAH,EAAAA,EAAE,CAAC,6DAAD,EAAgE,YAAY;AAC1E,UAAMI,IAAI,GAAG,IAAIC,yBAAJ,CAAgBC,cAAhB,CAAb;AACAF,IAAAA,IAAI,CAACG,KAAL,CAAY,sCAAqCC,IAAI,CAACC,GAAL,EAAW,EAA5D,EACGC,KADH,CACS,GADT,EACc,CACV;AAEIC,MAAAA,SAAS,EAAE;AAFf,KADU,CADd;AASAf,IAAAA,eAAe;AAX2D,sBAYnDlB,OAZmD;AAAA,UAYlEkC,WAZkE,aAYlEA,WAZkE;AAa1E,UAAMC,kBAAkB,GAAG,MAAM,4BAAe,MAAMD,WAAW,CAAC,oBAAD,CAAhC,CAAjC;AACAV,IAAAA,MAAM,CAACW,kBAAkB,CAACC,SAApB,CAAN,CAAqCC,IAArC,CAA0C,kBAA1C;AAED,GAhBD,CAAF;AAoBAf,EAAAA,EAAE,CAAC,iDAAD,EAAoD,YAAY;AAC9D,UAAMI,IAAI,GAAG,IAAIC,yBAAJ,CAAgBC,cAAhB,CAAb;AACAF,IAAAA,IAAI,CAACG,KAAL,CAAY,0BAAZ,EACGG,KADH,CACS,GADT,EAEI;AACIM,MAAAA,IAAI,EAAE,MADV;AAEIC,MAAAA,EAAE,EAAE,YAFR;AAGIC,MAAAA,GAAG,EAAE;AAHT,KAFJ;AASAtB,IAAAA,eAAe;AAX+C,sBAYvClB,OAZuC;AAAA,UAYtDkC,WAZsD,aAYtDA,WAZsD;AAa9D,UAAMO,SAAS,GAAG,MAAM,4BAAe,MAAMP,WAAW,CAAC,cAAD,CAAhC,CAAxB;AACAV,IAAAA,MAAM,CAACiB,SAAS,CAACL,SAAX,CAAN,CAA4BC,IAA5B,CAAiC,iBAAjC;AAGA,UAAMK,WAAW,GAAG,MAAM,4BAAe,MAAMR,WAAW,CAAC,gBAAD,CAAhC,CAA1B;AACAV,IAAAA,MAAM,CAACkB,WAAW,CAACN,SAAb,CAAN,CAA8BC,IAA9B,CAAmC,sBAAnC;AAEA,UAAMM,UAAU,GAAG,MAAM,4BAAe,MAAMT,WAAW,CAAC,eAAD,CAAhC,CAAzB;AACAV,IAAAA,MAAM,CAACmB,UAAU,CAACP,SAAZ,CAAN,CAA6BC,IAA7B,CAAkC,yBAAlC;AAED,GAvBD,CAAF;AAyBEf,EAAAA,EAAE,CAAC,gCAAD,EAAmC,YAAY;AAC/C,UAAMI,IAAI,GAAG,IAAIC,yBAAJ,CAAgBC,cAAhB,CAAb;AACAF,IAAAA,IAAI,CAACG,KAAL,CAAW,uCAAX,EACGG,KADH,CACS,GADT,EACc,CACV;AACEC,MAAAA,SAAS,EAAE;AADb,KADU,CADd;AAMAf,IAAAA,eAAe;AARgC,sBASzBlB,OATyB;AAAA,UASvC4C,SATuC,aASvCA,SATuC;AAU/C,UAAMF,WAAW,GAAG,MAAM,4BAAe,MAAME,SAAS,CAAC,SAAD,CAA9B,CAA1B;AACApB,IAAAA,MAAM,CAACkB,WAAD,CAAN,CAAoBG,WAApB;AACD,GAZC,CAAF;AAcAvB,EAAAA,EAAE,CAAC,wBAAD,EAA2B,YAAY;AACvC,UAAMI,IAAI,GAAG,IAAIC,yBAAJ,CAAgBC,cAAhB,CAAb;AACAF,IAAAA,IAAI,CAACG,KAAL,CAAY,wBAAZ,EACGG,KADH,CACS,GADT,EACa,CACT;AACAc,MAAAA,EAAE,EAAE,GADJ;AAEAC,MAAAA,KAAK,EAAE,CAFP;AAGAC,MAAAA,OAAO,EAAE,CAHT;AAIAC,MAAAA,IAAI,EAAE,MAJN;AAKAC,MAAAA,MAAM,EAAE,WALR;AAMAC,MAAAA,MAAM,EAAE,SANR;AAOAC,MAAAA,KAAK,EAAE,WAPP;AAQAb,MAAAA,EAAE,EAAE,YARJ;AASAc,MAAAA,IAAI,EAAE,IATN;AAUAC,MAAAA,MAAM,EAAE,IAVR;AAWAC,MAAAA,WAAW,EAAG,EAXd;AAYAC,MAAAA,IAAI,EAAE,IAZN;AAaAC,MAAAA,IAAI,EAAE,IAbN;AAcAC,MAAAA,SAAS,EAAC;AAdV,KADS,CADb;AAoBAxC,IAAAA,eAAe;AAtBwB,sBAuBjBlB,OAvBiB;AAAA,UAuB/B4C,SAvB+B,aAuB/BA,SAvB+B;AAwBvC,UAAMF,WAAW,GAAG,MAAM,4BAAe,MAAME,SAAS,CAAC,MAAD,CAA9B,CAA1B;AACApB,IAAAA,MAAM,CAACkB,WAAD,CAAN,CAAoBG,WAApB;AACD,GA1BC,CAAF;AA4BAvB,EAAAA,EAAE,CAAC,uBAAD,EAA0B,YAAY;AACtC,UAAMI,IAAI,GAAG,IAAIC,yBAAJ,CAAgBC,cAAhB,CAAb;AACAF,IAAAA,IAAI,CAACG,KAAL,CAAY,0BAAZ,EACGG,KADH,CACS,GADT,EACa;AACT2B,MAAAA,MAAM,EAAE,CACN;AACEC,QAAAA,IAAI,EAAE,SADR;AAEEC,QAAAA,KAAK,EAAE,UAFT;AAGEC,QAAAA,OAAO,EAAE,WAHX;AAIEC,QAAAA,QAAQ,EAAE,EAJZ;AAKEzB,QAAAA,IAAI,EAAE;AALR,OADM,EAQN;AACEsB,QAAAA,IAAI,EAAE,SADR;AAEEC,QAAAA,KAAK,EAAE,QAFT;AAGEC,QAAAA,OAAO,EAAE,YAHX;AAIEC,QAAAA,QAAQ,EAAE,EAJZ;AAKEzB,QAAAA,IAAI,EAAE;AALR,OARM;AADC,KADb;AAmBApB,IAAAA,eAAe;AArBuB,sBAsBhBlB,OAtBgB;AAAA,UAsB9B4C,SAtB8B,aAsB9BA,SAtB8B;AAuBtC,UAAMoB,YAAY,GAAG,MAAM,4BAAe,MAAMpB,SAAS,CAAC,WAAD,CAA9B,CAA3B;AACApB,IAAAA,MAAM,CAACwC,YAAD,CAAN,CAAqBnB,WAArB;AACA,UAAMoB,YAAY,GAAG,MAAM,4BAAe,MAAMrB,SAAS,CAAC,YAAD,CAA9B,CAA3B;AACApB,IAAAA,MAAM,CAACyC,YAAD,CAAN,CAAqBpB,WAArB;AACD,GA3BC,CAAF;AA6BAvB,EAAAA,EAAE,CAAC,gCAAD,EAAmC,MAAM;AACzC;AACA4C,IAAAA,MAAM,CAACC,UAAP,GAAoB,GAApB,CAFyC,CAIzC;;AACAD,IAAAA,MAAM,CAACE,aAAP,CAAqB,IAAIC,KAAJ,CAAU,QAAV,CAArB;AAEAnD,IAAAA,eAAe;AAP0B,sBAQjBlB,OARiB;AAAA,UAQjCkC,WARiC,aAQjCA,WARiC;AASzCV,IAAAA,MAAM,CAACU,WAAW,CAAC,gBAAD,CAAZ,CAAN,CAAsCW,WAAtC;;AACAyB,sBAAUC,KAAV,CAAgBrC,WAAW,CAAC,gBAAD,CAA3B;;AACAV,IAAAA,MAAM,CAACU,WAAW,CAAC,WAAD,CAAZ,CAAN,CAAiCsC,iBAAjC,CAAmD,MAAnD;AACD,GAZC,CAAF;AAcAlD,EAAAA,EAAE,CAAC,gDAAD,EAAmD,YAAY;AAC/DzB,IAAAA,IAAI,CAAC4E,aAAL;AACA,UAAM/C,IAAI,GAAG,IAAIC,yBAAJ,CAAgBC,cAAhB,CAAb;AACAF,IAAAA,IAAI,CAACG,KAAL,CAAW,+BAAX,EACGG,KADH,CACS,GADT,EAEI;AACI0C,MAAAA,OAAO,EAAE,CADb;AAEIC,MAAAA,QAAQ,EAAE,CAFd;AAGIC,MAAAA,QAAQ,EAAE,CAHd;AAIIC,MAAAA,SAAS,EAAE,GAJf;AAKIC,MAAAA,UAAU,EAAE,CALhB;AAMIC,MAAAA,UAAU,EAAE;AANhB,KAFJ,EAUIC,KAVJ,GAUYhD,KAVZ,CAUkB,GAVlB,EAUuB,EAVvB;AAWAd,IAAAA,eAAe;AACfrB,IAAAA,IAAI,CAACoF,mBAAL,CAAyB,IAAzB;AAf+D,sBAgBzCjF,OAhByC;AAAA,UAgBxDkC,WAhBwD,aAgBxDA,WAhBwD;AAiB/D,UAAMgD,eAAe,GAAG,MAAM,4BAAe,MAAMhD,WAAW,CAAC,WAAD,CAAhC,CAA9B;AACAV,IAAAA,MAAM,CAAC0D,eAAe,CAAC9C,SAAjB,CAAN,CAAkCC,IAAlC,CAAuC,GAAvC;AACD,GAnBC,CAAF;AAqBL,CApMO,CAAR","sourcesContent":["\nimport Dashboard from \"./index\";\nimport { createMount } from '@material-ui/core/test-utils';\nimport React from \"react\";\nimport {render,fireEvent, cleanup, waitForElement, getNodeText} from \"@testing-library/react\";\nimport { Provider } from \"react-redux\";\nimport \"@testing-library/jest-dom/extend-expect\";\nimport { I18nextProvider } from \"react-i18next\";\n//import axiosMock from 'axios';\n\nimport axios from 'axios';\nimport MockAdapter from 'axios-mock-adapter'\nimport { createMemoryHistory } from 'history';\nimport {Router} from 'react-router-dom';\nimport { createStore, combineReducers,applyMiddleware,compose } from \"redux\";\nimport createSagaMiddleware from 'redux-saga'\nimport rootSaga from \"../../sagas/indexSaga\"\nimport headerReducer from \"../../store/reducers/headerReducer\";\nimport dashboardReducer from \"../../store/reducers/dashboardReducer\";\nimport configurationsettingReducer from \"../../store/reducers/configurationsettingReducer\";\nimport BMCAuthenticationReducer from \"../../store/reducers/BMCAuthenticationReducer\";\nimport i18n from \"../../i18n\";\n\njest.unmock('axios');\n\n\ndescribe(\"Dashboard\", () => {\n    let wrapper;\n    let history;\n    let store;\n\n    beforeEach(() => {\n      const sagaMiddleware = createSagaMiddleware();\n      const rootReducers = combineReducers({\n        headerReducer,\n        dashboardReducer,\n        configurationsettingReducer,\n        BMCAuthenticationReducer\n      });\n      const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n      store = createStore(rootReducers,composeEnhancers(applyMiddleware(sagaMiddleware)))\n      sagaMiddleware.run(rootSaga);\n      const route = '/';\n      history = createMemoryHistory({ initialEntries: [route] })\n  \n\n    });\n\n    \n    const renderComponent = () => {\n        wrapper = render(\n          <Router history={history}>\n          <I18nextProvider i18n={i18n}>\n            <Provider store={store}>\n              {\" \"}\n              <Dashboard />\n            </Provider>\n          </I18nextProvider>\n          </Router>\n        );\n    };\n  \n    afterEach(cleanup);\n  \n    it(\"matches snapshot\", () => {\n      renderComponent();\n      const { asFragment } = wrapper;\n      expect(asFragment()).toMatchSnapshot();\n    });\n\n\n    it(\"should display available storage value as received from API\", async () => {\n        const mock = new MockAdapter(axios);\n        mock.onGet(`/api/v1.0/available_storage/?ts= + ${Date.now()}`)\n          .reply(200, [\n            {\n              \n                arraySize: 0, \n              \n            }\n        ]\n          );\n        renderComponent();\n        const { getByTestId} = wrapper;\n        const readStorageElement = await waitForElement(() => getByTestId(\"dashboard-no-array\"));\n        expect(readStorageElement.innerHTML).toBe(\"No Array Created\");\n\n      });\n\n\n      \n    it(\"should display system info as received from API\", async () => {\n        const mock = new MockAdapter(axios);\n        mock.onGet(`/api/v1.0/get_ip_and_mac`)\n          .reply(200,         \n            {\n                host: \"init\", \n                ip: \"10.1.11.91\", \n                mac: \"00:50:56:ad:88:56\"\n              } \n        \n          );\n        renderComponent();\n        const { getByTestId} = wrapper;\n        const ipElement = await waitForElement(() => getByTestId(\"dashboard-ip\"));\n        expect(ipElement.innerHTML).toBe(\"IP : 10.1.11.91\");\n\n\n        const hostElement = await waitForElement(() => getByTestId(\"dashboard-host\"));\n        expect(hostElement.innerHTML).toBe(\"Poseidon Name : init\");\n\n        const macElement = await waitForElement(() => getByTestId(\"dashboard-mac\"));\n        expect(macElement.innerHTML).toBe(\"MAC : 00:50:56:ad:88:56\");\n\n      });\n\n      it(\"should display storage details\", async () => {\n        const mock = new MockAdapter(axios);\n        mock.onGet(/api\\/v1\\.0\\/available_storage\\/\\?ts=*/)\n          .reply(200, [\n            {\n              arraySize: 4768219004928\n            }\n          ]);\n        renderComponent();\n        const { getByText } = wrapper;\n        const hostElement = await waitForElement(() => getByText(\"4.34 TB\"));\n        expect(hostElement).toBeDefined();\n      });\n\n      it(\"should display volumes\", async () => {\n        const mock = new MockAdapter(axios);\n        mock.onGet(`/api/v1.0/get_volumes/`)\n          .reply(200,[\n            {         \n            id:\t'0',\n            maxbw\t:0,\n            maxiops:\t0,\n            name:\t'vol2',\n            remain:\t10737418240,\n            status:\t'Mounted',\n            total:\t10737418240,\n            ip:\t'10.1.11.91',\n            port:\t'NA',\n            subnqn:\t'NA',\n            description : \"\",\t\n            unit:\t'GB',\n            size:\t'10',\n            usedspace:0\n            }\n          ]\n          );\n        renderComponent();\n        const { getByText } = wrapper;\n        const hostElement = await waitForElement(() => getByText(\"vol2\"));\n        expect(hostElement).toBeDefined();\n      });\n\n      it(\"should display alerts\", async () => {\n        const mock = new MockAdapter(axios);\n        mock.onGet(`/api/v1.0/get_alert_info`)\n          .reply(200,{\n            alerts: [\n              {\n                time: 104256782,\n                level: 'CRITICAL',\n                message: 'CPU Alert',\n                duration: 10,\n                host: 'iBoF'\n              },\n              {\n                time: 104256783,\n                level: 'NORMAL',\n                message: 'iBoF Alert',\n                duration: 10,\n                host: 'iBoF'\n              }\n            ]\n          });\n        renderComponent();\n        const { getByText } = wrapper;\n        const hostElement1 = await waitForElement(() => getByText(\"CPU Alert\"));\n        expect(hostElement1).toBeDefined();\n        const hostElement2 = await waitForElement(() => getByText(\"iBoF Alert\"));\n        expect(hostElement2).toBeDefined();\n      });\n\n      it('should render button on resize', () => {\n        // Change the viewport to 500px.\n        global.innerWidth = 500;\n\n        // Trigger the window resize event.\n        global.dispatchEvent(new Event('resize'));\n\n        renderComponent();\n        const { getByTestId } = wrapper;\n        expect(getByTestId(\"sidebar-toggle\")).toBeDefined();\n        fireEvent.click(getByTestId(\"sidebar-toggle\"));\n        expect(getByTestId(\"help-link\")).toHaveTextContent(\"Help\");\n      });\n\n      it(\"should display iops value as received from API\", async () => {\n        jest.useFakeTimers();\n        const mock = new MockAdapter(axios);\n        mock.onGet(/\\/api\\/v1\\.0\\/perf\\/all\\?ts=*/)\n          .reply(200,\n            {\n                bw_read: 0,\n                bw_total: 0,\n                bw_write: 0,\n                iops_read: 154,\n                iops_total: 0,\n                iops_write: 154\n            }\n          ).onAny().reply(200, {});\n        renderComponent();\n        jest.advanceTimersByTime(2000);\n        const {getByTestId} = wrapper;\n        const readIopsElement = await waitForElement(() => getByTestId(\"read-iops\"));\n        expect(readIopsElement.innerHTML).toBe(\"0\");\n      });\n  \n});"]}